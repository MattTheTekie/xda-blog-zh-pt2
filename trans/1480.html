<html>
<head>
<title>Here are all the hidden changes in Android 11 we learned from source code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>以下是我们从源代码中了解到的Android 11的所有隐藏变化</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/hidden-changes-android-11-source-code/#0001-01-01">https://www.xda-developers.com/hidden-changes-android-11-source-code/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>在为其Pixel设备系列发布Android 11的第一个稳定版本后不久，谷歌<a href="https://www.xda-developers.com/android-11-source-code-aosp/">开始向AOSP上传Android 11源代码</a>。我们一直在代码中挖掘，寻找我们在<a href="https://www.xda-developers.com/tag/android-11/">之前的报道</a>中可能遗漏的隐藏功能，下面是我们的发现:</p>

 
<h2 id="new-volume-stream-for-virtual-assistants">虚拟助理的新音量流</h2>
<p>Andriod 11 <a href="https://android.googlesource.com/platform/frameworks/base/+/b64fac77b551480c0cd51b0ee21c7c9d66af3374%5E%21/">为虚拟助手引入了新的流类型</a>:AUDIO _ STREAM _ ASSISTANT。新的流是<em>“打算由一个虚拟助理使用，如谷歌助理，Bixby等。音频流有自己的音量别名，音量不会因其他流的音量变化而改变。</em></p>

<p>目前，虚拟助理应用程序通常通过媒体音量流发送音频，由其他媒体应用程序共享。有了新的流，Android 11应该允许虚拟助理应用程序的开发者通过这个新的流发送音频，让用户独立于其他媒体应用程序设置助理音量。</p>
<p class="ad-odd"> </p>


<h2 id="clock-plugins-in-android-11">Android 11中的时钟插件</h2>
<p>在Android 10中，我们发现了关于<a href="https://www.xda-developers.com/android-q-lock-screen-clock-customization/">锁屏时钟定制</a>的工作，它提供了3种不同的选项:默认、文本、气泡和模拟。这项功能本来可以在Pixel Themes应用程序(“风格&amp;壁纸”)中作为一个名为“时钟”的独立选项卡提供，但是，它没有在最终的Android 10版本中推出。</p>

<p>虽然该功能在Android 11稳定版中仍然不可用，但谷歌已经<a href="https://android.googlesource.com/platform/frameworks/base/+/5db44f0ece5c641f6be625381f53ce0b54174c18">重新启用了</a>自定义时钟功能。但由于谷歌在Android 10中移除了文本时钟，并在Android 11中移除了模拟时钟和气泡时钟，因此目前没有其他时钟选项可用。</p>

<p>我们怀疑谷歌要么只为原始设备制造商启用了该功能，要么该公司可能正在开发新的定制时钟，以便在Pixel 5和Pixel 4a 5G上与更新的Pixel Themes应用程序一起推出。</p>
<p class="ad-even"> </p>


<h2 id="freezing-cached-apps">冻结缓存的应用程序</h2>
<p>在Android 11 Beta 2中，我们<a href="https://www.xda-developers.com/android-11-beta-2-new-features/#gallery-3:~:text=Suspended%20execution%20for%20cached%20apps">发现了一个正在开发的新功能</a>，名为“暂停缓存应用的执行”当时，我们了解到该功能将存在于开发人员选项中，但我们没有足够的信息来了解它如何工作或如何启用它。</p>

<p>不过，从源代码中，<a href="https://android.googlesource.com/platform/frameworks/base/+/bdaf16e72aedf06f007c1a8b288c68ee470277d1">我们可以看到</a>该特性旨在<em>“在缓存时冻结应用程序，并在从缓存中移除或终止后解冻它们。冻结的应用程序不会使用任何CPU周期，从而减少了可能试图在缓存时运行的不当进程的功耗。”</em></p>

<p>XDA公认开发者<a href="https://forum.xda-developers.com/member.php?u=5778309"> <em> luca020400 </em> </a>说这个功能需要更新的cgroups(一个Linux内核功能)，所以在目前的设备上无法工作。它可以是针对OEM的特征，或者可以在Pixel 5上实现。</p>
<p class="ad-odd"> </p>


<h2 id="blur-for-notification-shade">通知阴影模糊</h2>
<p>在Android 11开发者预览版3中，我们设法启用了一个隐藏的<a href="https://www.xda-developers.com/android-11-developer-preview-3-changes/#gallery-10-302302:~:text=Window%20blurs,-A%20hidden">开关来启用窗口模糊</a>。然而，当时这种开关不起作用。XDA公认的开发商<a href="https://forum.xda-developers.com/member.php?u=5778309"> <em> luca020400 </em> </a>现在<a href="https://twitter.com/luca020400/status/1303702842855878656">设法让它工作</a>。</p>

 



<p>他在华硕ZenFone 6上闪现了Android 11 GSI，并通过更改系统属性启用了该功能。该功能在下拉通知面板后启用Kawase模糊效果，这是高斯模糊的一种近似。</p>
<p class="ad-even"> </p>


<h2 id="deep-press-support-for-expanding-notifications-in-android-11">Android 11中扩展通知的深度新闻支持</h2>
<p>在<a href="https://www.xda-developers.com/pixel-feature-drop-second-features-list/#tagbar-list:~:text=VOIP.-,Long%20press%20improvements">第二个Pixel功能下降</a>中，谷歌增加了“改进的长按选项”，让你在Pixel Launcher、Google Photos和Google Drive中牢牢按住屏幕，以显示上下文菜单。这是访问上下文菜单的另一种方式，它是为那些可能不知道他们可以通过长按屏幕来访问它的人设计的。</p>

<p>该特性利用了Deep Press API，该API使用ML模型来推断用户何时在屏幕上更用力地按压。在Android 11中，你现在可以在通知面板中的通知上做一个<a href="https://android.googlesource.com/platform/frameworks/base/+/4716913d96b821b757e40a1e1a96b492e5c5ebac">深按来展开它们。</a></p>
<p class="ad-odd"> </p>


<h2 id="what-is-gabeldorsche">什么是Gabeldorsche？</h2>
<p>Android 11的开发者选项有一个名为“启用Gabeldorsche”的开关，描述为“启用蓝牙Gabeldorsche功能堆栈”谷歌终于发布了Gabeldorsche的文档，这似乎是对Android蓝牙协议栈的彻底重写。希望重写将导致更低的延迟和更高的稳定性。如果你有兴趣了解更多，现在就可以查看Gabeldorsche蓝牙栈<a href="https://cs.android.com/android/platform/superproject/+/master:system/bt/gd/docs/architecture/architecture.md?q=Gabeldorsche">架构</a>和<a href="https://cs.android.com/android/platform/superproject/+/master:system/bt/gd/docs/architecture/style_guide.md?q=Gabeldorsche">风格指南</a>。请注意，GD蓝牙栈还没有准备好推出，很可能会在Android 12或更高版本中推出。</p>
<p class="ad-even"> </p>


<h2 id="what-is-enhanced-connectivity">什么是增强型连接？</h2>
<p><a href="https://www.xda-developers.com/android-11-developer-preview-2-changes/#gallery-4:~:text=New%20%E2%80%9CEnhanced%20Connectivity%E2%80%9D%20toggle"> Android 11开发者预览版2 </a>增加了另一个神秘的开发者选项，名为“增强连接”，但没有任何关于其功能的描述。感谢源代码，我们现在已经了解到，该功能将“允许连接热功率管理器在蜂窝吞吐量低于设定阈值时主动关闭5G，以节省功率。”</p>
<p class="ad-odd"> </p>


<h2 id="multi-audio-focus">多音频焦点</h2>
<p>早在5月份，我们报道了一个名为<a href="https://www.xda-developers.com/app-volume-control-individual-volume-levels-android/"> App Volume Control </a>的根应用，它可以让你控制Android应用的单个音量。这是必要的，因为Android没有像Windows那样的原生音量混合器，所以你不能混合多个应用程序同时播放音频的音量。Android有“音频焦点”的概念，一次只能有一个应用程序有焦点。</p>

<p>具有音频焦点的应用程序决定其他播放音频的应用程序会发生什么——闪避(降低音量)或暂停播放。这意味着用户无法控制他们最喜欢的音乐应用程序是否总是在他们打开的任何应用程序中播放，如果该应用程序取消了音频焦点并选择暂停播放。在Android 11中，看起来谷歌正在开发一个<a href="https://android.googlesource.com/platform/frameworks/base/+/4e984e55033439223fb45e91a561b85e57248067">多音频聚焦功能</a>，这将允许应用程序同时播放音频，而不会暂停或回避彼此。</p>
<p class="ad-even"> </p>


<h2 id="faster-share-sheet">更快的共享表</h2>
<p>除了Android 10 中的<a href="https://www.xda-developers.com/android-10-share-menu-faster-quantified/">增强功能，谷歌还对Android 11中的份额表进行了一些改进。例如，图标的</a><a href="https://android.googlesource.com/platform/frameworks/base/+/563d7b9d17c913198554aad2d37e60c1d3ffc196">加载现在被缓存</a>，这意味着它们出现得更快。<a href="https://android.googlesource.com/platform/frameworks/base/+/706316db0fec414785dfa870ae20592cd3bf09e1"> Scroll jankiness也有所减少</a>通过缓存ViewHolder中的itemViewType，缓存shouldDisplayLandscape的结果来减少滚动时的IPC调用次数，缓存work profile用户句柄。</p>
<p class="ad-odd"> </p>


<h2 id="better-memory-management">更好的内存管理</h2>
<p>谷歌推出了<a href="https://android.googlesource.com/platform/frameworks/base/+/android11-release/services/core/java/com/android/server/am/OomAdjuster.md">新的OOM调整器设计</a> (OOM =内存不足，即当空闲内存量接近耗尽时，系统应该做什么)。OOM Adjuster调整有3个因素:进程状态(确定一个进程是在前台还是后台)，OOM Adj分数(由低内存杀手守护进程或lmkd使用，以确定当内存不足时应该终止哪个进程)，以及调度程序组(调整CPU进程组和线程优先级)。</p>

<p>系统服务器为4种不同的Android进程调整这3个因素:活动、服务、内容提供商和广播接收器。OOM Adjuster旨在避免在<em>“会导致用户可察觉的服务中断”的情况下终止进程</em></p>
<p class="ad-even"> </p>


<h2 id="android-11-go-edition-improvements">Android 11 Go版改进</h2>
<p>低RAM设备(读作:Android Go Edition)现在可以支持<a href="https://android.googlesource.com/platform/frameworks/base/+/bd16014d0b211fb369abc1f928751b65e2644930">多用户、托管配置文件</a>和<a href="https://android.googlesource.com/platform/frameworks/base/+/bc79dcd87b95f4332d9319dd2230f18f49dcf9cb">通知监听器</a>。对于多用户和管理配置文件，谷歌只取消了阻止它们在低RAM设备上工作的运行时限制，因此原始设备制造商仍需要进行一些配置更改才能让它们工作。不过，通知监听器(被授权拦截通知的应用程序，如Pushbullet)应该可以在没有原始设备制造商输入的情况下工作。</p>
<p class="ad-odd"> </p>


<h2 id="wcg-wallpaper-support">WCG壁纸支持</h2>
<p>10位(宽彩色)图像<a href="https://android.googlesource.com/platform/frameworks/base/+/287d8283f4f232a0a31ef038e61b1c2340ef660b%5E%21/">现在可以在Android 11中设置为壁纸</a>。以前，应用这样的壁纸总是会让他们转化为sRGB。有趣的是，转换过程中的一个错误导致了今年早些时候臭名昭著的诅咒壁纸崩溃。</p>
<p class="ad-even"> </p>


<h2 id="volume-key-customization">卷密钥定制</h2>
<p>谷歌似乎正在开发一个API来检测音量键的单按、双击或三击。我们已经发现了两个名为“<a href="https://android.googlesource.com/platform/frameworks/base/+/4bf177f046e5fe43c775e497e4f2495eda06e302%5E%21/">支持音量键</a>的定制”和“<a href="https://android.googlesource.com/platform/frameworks/base/+/34e68a43d3d366acf8453c53d51fa2b149510bee%5E%21/">支持单击/双击/三击</a>的定制”的提交，这两个提交指向了Android 11中这个未记录的更改。要启用该功能，长/单/双/三次按键将根据按键事件的时间长度和模式进行区分。</p>

<p>使用辅助服务的应用程序，如flar2的<a href="https://play.google.com/store/apps/details?id=flar2.homebutton"> ButtonMapper </a>应用程序，已经可以拦截音量按钮按压的KeyEvent，并使用自己的逻辑来确定用户进行了哪种按压。看起来谷歌现在正在为这种定制编写原生支持，但我们不确定它是否将用于支持Pixel设备上的功能，或者它只是在考虑OEM的情况下编写的。没有证据表明该功能将被用于改变音乐曲目，它可能只是用于安全相关的功能，例如，检测何时按下音量键三次以发送SOS。有趣的是，Android <a href="https://www.xda-developers.com/skip-music-tracks-android-volume-keys-no-root/">已经有一个隐藏的API </a>来检测音量键的长按。</p>
<p class="ad-odd"> </p>


<h2 id="automatic-unlocking-of-work-profile-by-digital-wellbeing">通过数字福利自动解锁工作档案</h2>
<p>在<a href="https://www.xda-developers.com/digital-wellbeing-prepares-add-work-profile-scheduler-pause-apps-automatically/">Digital well being 1 . 0 . 327635162</a>中，我们发现了一个新的工作调度功能的字符串，该功能将在预定时间到达时自动禁用工作配置文件。在Android 11中，数字福利现在可以<a href="https://android.googlesource.com/platform/frameworks/base/+/a8c58f06d06e1a69b0f3555678f51f679da8ea30">自动解锁工作档案</a>，为这一功能的到来铺平了道路。</p>

<hr/>

<p>如果你想了解更多关于Android 11中引入的所有变化，请查看我们关于第一个<a href="https://www.xda-developers.com/android-11-stable-google-pixel-oneplus-xiaomi-realme-oppo/"> Android 11稳定版本</a>和<a href="https://www.xda-developers.com/android-11-features-developers-new-apis/">开发者关注的变化</a>的帖子。要在您的设备上安装最新的更新，您可以查看下面链接的Android 11更新跟踪器。</p>

<p/><p><strong> <a href="https://www.xda-developers.com/android-11-update-tracker/"> Android 11更新跟踪器</a> || <a href="https://www.xda-developers.com/xiaomi-android-11-update-list-download-install/">小米Android 11跟踪器</a> || <a href="https://www.xda-developers.com/oneplus-android-11-official-oxygenos-11-beta-stable-tracker-download-install/">一加Android 11跟踪器</a> </strong></p>

 </div>


</div>    
</body>
</html>