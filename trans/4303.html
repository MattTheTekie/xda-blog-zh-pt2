<html>
<head>
<title>A Revolution in Custom ROMs: How Project Treble makes Porting Android Oreo a 1 Day Job</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>定制rom的革命:Treble项目如何让移植Android Oreo成为一日工作</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/how-project-treble-revolutionizes-custom-roms-android-oreo/#0001-01-01">https://www.xda-developers.com/how-project-treble-revolutionizes-custom-roms-android-oreo/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>多年来，XDA论坛一直是定制ROM开发的中心聚会。多亏了我们论坛上开发人员的辛勤工作，许多旧的Android智能手机在被设备制造商抛弃多年后，仍能通过定制ROMS存活下来。虽然现在大多数制造商都发布了引导加载程序解锁方法，但内核源代码发布的频繁延迟抑制了许多智能手机上的定制ROM开发。然而，这种情况可能很快就会改变，这要归功于Android Oreo发布前宣布的一项名为“<a href="https://www.xda-developers.com/googles-project-treble-modularize-android-so-oems-can-update-devices-faster/"> Project Treble </a>”的计划。多亏了Project Treble，将AOSP ROM移植到设备上的时间不再需要几周或几个月——相反<strong>只需要几天</strong>。</p>

  
<p>对于那些多年来一直关注自定义ROM场景的人来说，你可能已经意识到这个消息的重要性。XDA认可的开发者<a href="https://forum.xda-developers.com/member.php?u=4960686"> OldDroid </a>称这一发现为定制AOSP ROM开发中的<strong>突破</strong>。例如，由于Project Treble的支持，<a href="https://www.xda-developers.com/stock-android-oreo-huawei-mate-9-project-treble/">我能够在华为Mate 9 上启动</a>一个<strong>几乎全功能的Android 8.0 Oreo ROM这款设备到目前为止甚至没有见过一个AOSP <em> Android牛轧糖</em> ROM。</strong></p>

 
<p class="w-rich w-youtube" id="hFGgSpgpI5M">  </p>


<p>由于XDA资深会员phhusson在这方面的初步开发努力，我们可能很快就会看到定制ROM开发的一场革命。经过20个小时的研究、开发和调试，phhusson创建了一个系统映像，可以在来自不同制造商的多种设备上使用完全不同的SOC进行<strong>引导。例如，我在自己的华为Mate 9上启动的相同系统映像也可以在Honor 8 Pro、Honor 9、索尼Xperia XZ1 Compact和Essential Phone上启动。也就是说<em> 3个不同的OEM厂商</em>(华为/Honor、索尼、Essential)和<em> 2个不同的SOC</em>(海思麒麟960和高通骁龙835)，这个单一系统镜像可以成功引导。</strong></p>

<p>在未来，我们可能会看到一个单一的系统映像可以在几十种不同的Android智能手机上运行，就像微软Windows可以在几乎任何计算机硬件上运行一样。为了鼓励这方面的更多发展，我们已经开放了一个专门针对支持三重功能的设备的新论坛。这个论坛目前是面向开发者的，所以请不要开始一个新的话题，除非你对开发有兴趣。如果您希望帮助测试Treble兼容的系统图像，请随时在现有线程上留下评论。</p>

<p/><p><a href="https://forum.xda-developers.com/project-treble"> <strong>加入项目三宝发展论坛</strong> </a></p>

<p>考虑到这一发展的重要性和主题的复杂性，我想我会以不同于其他文章的方式来处理这篇文章。我将列出一个要点列表，解释人们可能会有的一些常见问题，并指出关于这一最新发展的关键事实。</p>

<hr/>


<h2 id="what-is-project-treble">什么是高音项目？</h2><div class="body-img landscape"><div class="responsive-img image-expandable img-article-item" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png" data-modal-id="single-image-modal" data-modal-container-id="single-image-modal-container" data-img-caption="&quot;Credits: &lt;a href=\&quot;https:\/\/android-developers.googleblog.com\/2017\/05\/here-comes-treble-modular-base-for.html\&quot;&gt;Google&lt;\/a&gt;&quot;">
 
<figure> <picture>  <source media="(min-width: 1024px)" sizes="1500px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png?q=50&amp;fit=crop&amp;w=1500&amp;dpr=1.5"/> <source media="(min-width: 768px)" sizes="943px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png?q=50&amp;fit=crop&amp;w=943&amp;dpr=1.5"/> <source media="(min-width: 481px)" sizes="767px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png?q=50&amp;fit=crop&amp;w=767&amp;dpr=1.5"/> <source media="(min-width: 0px)" sizes="480px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png?q=50&amp;fit=crop&amp;w=480&amp;dpr=1.5"/> <img class="lazyload" alt="Android Oreo Project Treble" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png" src="../Images/d6d0e2ee2b8eb0dd27b2d4240647520d.png" data-original-src="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/05/Project-Treble-1024x556.png"/> </picture> <figcaption class="body-img-caption">Credits: <a href="https://android-developers.googleblog.com/2017/05/here-comes-treble-modular-base-for.html">Google</a></figcaption> </figure> </div>


 </div>


<p>Project Treble通常被描述为Google模块化Android操作系统框架以分离供应商特定代码的尝试。让我们再细分一下:</p>

<ul> <li>为设备带来新的Android版本的完整更新过程是一个漫长而复杂的话题，但索尼在这张概述基本步骤的信息图中做得很好。</li> <li>“供应商”通常是指硅制造商，如高通，但也可以指设备中任何其他专有硬件的制造商。“设备制造商”或“OEM”通常需要等待供应商更新他们的代码，以便专有硬件在新版本的Android中与Android OS框架一起工作。</li> <li>然而，Project Treble正在发生的事情是，谷歌要求任何<strong>供应商特定的代码从Android OS框架</strong>中分离出来，而是存在于自己的供应商实现中。通常这意味着现在在支持三重功能的智能手机上有一个单独的/供应商分区，其中包含一堆HALs(硬件抽象层)。</li> <li>此外，供应商必须实现让Android OS框架以标准化的方式与HALs通信的代码。这是通过<strong> HIDL </strong> (HAL接口定义语言)完成的。有了这一点，OEM就可以进行Android更新，而不必等待供应商更新他们的Hal。从理论上讲，这种<strong>应该会加快整个Android更新过程</strong>，因为供应商可以随时更新他们的代码<a href="https://www.xda-developers.com/project-treble-google-pixel-2-graphics-drivers/">，例如通过Play Store </a>。</li> <li>为了帮助理解什么是HAL以及它与Android的关系，让我们考虑一个类比。想象一辆车。方向盘和刹车是HAL，而驱动是Android OS框架。驾驶员(Android)移动方向盘并踩下刹车(HAL)以控制汽车(硬件)的运动。</li> <li>现在想象一下，如果我们生活在一个世界里，每个汽车制造商都决定以完全不同的方式设计他们的方向盘或重新安排他们的刹车。如果你让一名司机驾驶一辆新车，他可能会对最初如何驾驶车辆感到困惑。但多亏了标准，每个司机都应该熟悉如何操作几乎所有汽车的方向盘和刹车。此外，驾驶学校教所有的司机如何正确驾驶车辆。在这个类比中，车辆标准是Project Treble，驾校是HIDL。</li> </ul>

<hr/>
<div class="body-img portrait"><div class="responsive-img image-expandable img-article-item-portrait" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg" data-modal-id="single-image-modal" data-modal-container-id="single-image-modal-container" data-img-caption="&quot;Android Oreo on the Honor 8 Pro. Credits: XDA Recognized Developer OldDroid&quot;">
 
<figure> <picture>  <source media="(min-width: 1024px)" sizes="750px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg?q=50&amp;fit=crop&amp;dpr=1.5"/> <source media="(min-width: 768px)" sizes="750px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg?q=50&amp;fit=crop&amp;dpr=1.5"/> <source media="(min-width: 481px)" sizes="600px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg?q=50&amp;fit=crop&amp;dpr=1.5"/> <source media="(min-width: 0px)" sizes="360px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg?q=50&amp;fit=crop&amp;dpr=1.5"/> <img class="lazyload" alt="Project Treble Android Oreo" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg" src="../Images/3e75eca20a6318301b42fa1bafdc03c5.png" data-original-src="https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/11/Project-Treble-Android-Oreo-on-the-Honor-8-Pro-225x300.jpg"/> </picture> <figcaption class="body-img-caption">Android Oreo on the Honor 8 Pro. Credits: XDA Recognized Developer OldDroid</figcaption> </figure> </div>


 </div>

<p class="ad-odd"> </p>


<h2 id="what-devices-will-get-project-treble-support">哪些设备将获得Project Treble支持？</h2>
<ul> <li>所有<strong>推出的搭载安卓8.0奥利奥</strong>或以上<strong>的设备必须全面支持</strong> Project Treble。</li> <li>所有<strong>升级到Android 8.0 Oreo </strong>的设备都<strong>不需要</strong>完全支持Project Treble。</li> <li>有Android 8.0 Oreo更新(正式版或封闭测试版)并支持Treble的设备包括:</li> <li>通过定制ROM开发，任何设备都不太可能非正式地获得Project Treble支持。HALs毕竟不是开源的。</li> </ul>

<hr/>
<p class="ad-even"> </p>


<h2 id="why-is-project-treble-so-important-for-aosp-roms">为什么高音项目对AOSP罗姆如此重要？</h2>
<ul> <li>为了确保供应商代码以Project Treble要求的方式从Android OS框架中正确分离，谷歌建立了一个供应商测试套件(VTS)，设备必须通过该套件才能获得谷歌的认证。谷歌认证非常重要，因为没有它，设备就不能预装Google Play应用和服务。</li> <li>VTS中的一个要求是启用高音的设备<strong>必须能够引导</strong>原始的、通用的AOSP版本。由于这一要求，原始设备制造商不得不发运能够顺利启动AOSP的设备。</li> <li>尽管谷歌为VTS使用并与原始设备制造商共享的确切ROM并不公开，但XDA的高级成员phhusson能够找出如何从来源重新创建这个ROM。</li> <li>因此，我们现在有了一个工作的AOSP ROM，它保证可以在Project Treble设备上引导。大部分工作已经由原始设备制造商和供应商完成，所以我们论坛上的独立开发者不再需要<a href="https://www.xda-developers.com/cameras-custom-roms-developers-make-hardware-work-without-source-code/">摆弄内核源代码或HAL hackery </a>。理论上，AOSP只读存储器应该“正常工作”,我们已经在我们测试的设备上证明了这一点。</li> <li>目前，兼容性是<a href="https://forum.xda-developers.com/showpost.php?p=74622436&amp;postcount=3">不是100% </a>与所有设备的系统镜像可以启动。还有一些<a href="https://forum.xda-developers.com/showpost.php?p=74622542&amp;postcount=4">竞争条件</a>需要弄清楚。然而，Project Treble <strong>大大减少了将AOSP rom移植到非谷歌设备上所需的开发工作量。在我们的<a href="https://forum.xda-developers.com/project-treble">项目Treble forum </a>中，随着更多开发者的合作，我们期望看到Treble设备开发走得更远。</strong></li> </ul>

<hr/>
<p class="ad-odd"> </p>


<h2 id="how-do-i-try-out-android-oreo-on-my-device-now">现在如何在我的设备上试用Android Oreo？</h2>
<p>如果你真的很有冒险精神，想现在就在你的手机上尝试这些项目Treble builds中的一个，phhusson有你需要的系统图像，可以在我们的项目Treble论坛的<a href="https://forum.xda-developers.com/project-treble/trebleenabled-device-development/experimental-phh-treble-t3709659">他的帖子上下载。不过，有几件事你需要记住:</a></p>

<ul> <li>你需要一个<strong>解锁的引导程序</strong>，并且需要熟悉使用<strong>快速引导命令</strong>来刷新镜像。</li> <li>你的设备必须已经运行Android Oreo。这些系统映像不会“升级”您的设备。如果你运行的是本文中提到的华为/Honor设备，你可以在我们的论坛上寻找指导，或者使用<a href="https://www.reddit.com/r/FunkyHuawei/comments/7f88h5/updating_android_n_huawei_devices_to_android_o/"> FunkyHuawei.club服务</a>非正式地将你的手机更新到一个封闭的奥利奥测试版。</li> <li>你必须愿意在测试时<strong>丢失数据或刷新工厂图像</strong>。确保此引导的最佳方式是擦除userdata分区，包括擦除内部存储上的所有内容。当然，你可以做备份，并在完成后将它们转移过来。</li> <li>这些AOSP目前不是作为日常车手使用的。它们非常简单，不提供许多预装的功能或应用。你必须自己刷新谷歌应用程序。你必须手动输入运营商的APN设置才能使用移动数据(如果可以的话)。在投入更多的开发努力之前，事情会变得不顺利。</li> </ul>

<hr/>
<p class="ad-even"> </p>


<h2 id="conclusion">结论</h2>
<p>当谷歌说Project Treble可能是Android工作方式有史以来最大的变化之一时，他们不是在开玩笑。我们可以亲眼目睹，此时此地，它能产生多大的影响。Treble可能是开发社区振兴定制ROM场景所需要的推动力。在华为Mate 9上，不到一天的时间就启动了一个几乎功能齐全的AOSP ROM。我很高兴看到将为其他高音设备所做的工作。</p>

 </div>


</div>    
</body>
</html>