<html>
<head>
<title>How to flash a Generic System Image (GSI) on Project Treble supported devices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Project Treble支持的设备上闪现通用系统映像(GSI)</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/flash-generic-system-image-project-treble-device/#0001-01-01">https://www.xda-developers.com/flash-generic-system-image-project-treble-device/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>如果你只是顺便听说过Project Treble，但没有深入研究过它，那么你可能听说过它被认为有助于Android的主要更新更快地推出。在XDA，还有另一个我们已经详细讨论过的好处:能够在任何支持的设备上启动AOSP通用系统映像(GSI)。这意味着曾经运行大量定制Android版本的设备，如<a href="https://www.xda-developers.com/samsung-galaxy-s9-s9-plus-hands-on/">三星Galaxy S9 </a>上的<a href="https://www.xda-developers.com/samsung-experience-9-0-beta-android-oreo-features/">三星Experience </a>或<a href="https://www.xda-developers.com/huawei-mate-10-pro-porsche-official/">华为Mate 10 Pro </a>上的<a href="https://www.xda-developers.com/official-changelog-huawei-mate-9-android-oreo-update/"> EMUI 8 </a>，可以选择运行更接近于<a href="https://www.xda-developers.com/google-pixel-2-xl-announced-price/">谷歌Pixel 2 </a>的软件。</p>

  
<p>售后定制rom(由通常不隶属于某公司的独立开发人员制作的定制版本的Android软件)对XDA论坛来说是一个很大的吸引力，由于Project Treble需要对Android进行更改，支持Treble的设备将更容易基于Android开源项目(AOSP)更新定制rom。没有Project Treble，开发人员不得不采用许多技巧和方法来让他们的定制rom工作，虽然Treble支持不能解决所有问题，但它肯定有助于启动进程。</p>

<p>像<a href="https://www.xda-developers.com/stock-android-oreo-huawei-mate-9-project-treble/">华为Mate 9 </a>、<a href="https://www.xda-developers.com/lineageos-honor-view-10-huawei-mate-10-pro-project-treble/"> Honor View 10 </a>、<a href="https://www.xda-developers.com/project-treble-aosp-android-oreo-huawei-mate-10-pro/">华为Mate 10 Pro </a>、Honor 7X、<a href="https://www.xda-developers.com/samsung-galaxy-s9-aosp-android-8-1-oreo/"> Exynos三星Galaxy S9 </a>或<a href="https://www.xda-developers.com/obscure-mediatek-phone-kernel-source-android-oreo-project-treble/"> Allview V3 Viper </a>这样的设备要么由于缺乏开发者兴趣而没有基于AOSP的定制rom可用，要么rom缺乏一些基本的硬件功能。但正如我们在这些设备的情况下看到的那样，由于Treble支持，可用的rom大多是功能性的(在哪些有效哪些无效方面存在一些差异，社区已经<a href="https://github.com/phhusson/treble_experimentations/wiki">整理了一个wiki页面</a>您应该查看以找到该信息)。</p>

<p>由于Treble对用户来说是如此之新，而且与通常的定制rom相比，闪存的过程略有不同，所以关于如何将GSI闪存到Treble兼容设备上，存在很多困惑。本教程将大致引导你如何刷新这样一个ROM。根据设备的不同，可能会涉及一些不同的步骤，但一般来说，过程应该是相似的。以下是如何在兼容高音的安卓设备上闪现GSI的方法。</p>

<hr/>


<h2 id="how-to-flash-a-generic-system-image-on-a-project-treble-supported-device">如何在支持项目高音的设备上闪烁通用系统图像</h2>
<section class="emaki-custom-block emaki-custom-note"><div class="emaki-custom note" id="custom_block_6"><p><b>要求:</b></p><ul> <li>你的设备<b>必须</b>有一个<b>可解锁的引导程序</b>。</li> <li>您的设备<b>必须</b>与<b>项目高音兼容</b>。这意味着您的设备符合以下标准之一:<ul> <li>您的设备<b>安装了安卓8.0奥利奥或更新版本</b>(例如安卓8.1奥利奥)<b>，并通过了<a href="https://www.xda-developers.com/how-to-fix-device-not-certified-by-google-error/"> Google Play认证</a> </b>。(如果你对你的设备进行了rooted刷新了另一个定制的ROM，结果你的设备在Google Play中被列为未认证，那么不要担心。我们只关心设备发货时的状态。)</li> <li>您的设备升级到Android 8.0 Oreo或更高版本，并由制造商使<b>与Project Treble兼容。参见<a href="https://www.xda-developers.com/list-android-devices-project-treble-support/">这篇文章</a>获取此类设备的列表。</b></li> <li>您的设备不符合上述任何一个标准，但可以通过一种非官方的方式实现高音兼容。同样，请参考本文中的<a href="https://www.xda-developers.com/list-android-devices-project-treble-support/">以获取此类设备的列表。</a></li> </ul> </li> <li>您的设备不需要任何重大修改，例如Xposed Framework、SuperSU或Magisk。您可以在以后重新安装这些程序，但是在继续之前，请确保您使用的是普通的boot/ramdisk。</li> </ul> </div></section>
<p>三星Galaxy S8/S8+ ( <a href="https://www.xda-developers.com/how-to-install-android-oreo-on-the-samsung-galaxy-s8-s8-exynos/"> Exynos </a>或<a href="https://www.xda-developers.com/install-android-oreo-galaxy-s8-snapdragon/">骁龙</a>)、三星Galaxy Note 8 ( <a href="https://www.xda-developers.com/install-android-oreo-samsung-galaxy-note-8-exynos/"> Exynos </a>或<a href="https://www.xda-developers.com/samsung-galaxy-note-8-android-oreo-verizon-sprint/">骁龙</a>)、<a href="https://www.xda-developers.com/lg-v30-android-oreo-update-south-korea/"> LG V30 </a>、<a href="https://www.xda-developers.com/sony-xperia-xa1-series-android-oreo/">索尼Xperia XA1系列</a>等设备不符合这些标准中的任何一项，因此无法遵循本指南。虽然<a href="https://www.xda-developers.com/nokia-8-sirocco-nokia-7-plus-nokia-6-nokia-1-8110-reloaded/"> 2018诺基亚品牌的设备</a>和<a href="https://www.xda-developers.com/samsung-galaxy-s9-and-galaxy-s9-are-official-specifications-features-prices-and-availability/">骁龙三星Galaxy S9 </a>与Android Oreo一起推出，并支持Treble，但它们没有可解锁的引导加载器，因此无法刷新GSI。</p>

<p>请确保，即使您的设备被列为Treble-compatible，除非您已经正式或非正式地收到Android Oreo更新,否则您不会遵循本指南<b>。如果你的设备符合上述标准，那么你几乎准备好闪光GSI。我们需要说的最后一件事是，刷新GSI将需要您在工厂重置您的设备，所以请确保您在继续操作之前准备好丢失应用程序数据！我们建议您进行设备外备份(例如在您的PC或SD卡上)，以防出现任何问题。</b></p>

<hr/>

<h3 id="guide-to-flash-gsi-on-devices-that-support-project-treble">支持Project Treble的设备上的flash GSI指南</h3>
<p/><h4>为正式支持高音的设备做准备</h4>

<ol> <li>解锁您的设备的引导加载程序。您在此采取的步骤因设备而异。我们在门户网站和论坛上都有许多指南供您阅读。只要在谷歌上快速搜索“XDA解锁引导程序”+你的设备名，你就会找到很多指南。</li> <li>将您选择的GSI下载到您的PC上。你可以闪存一个纯AOSP ROM，如phh-Treble，或者如果你喜欢更多的功能，你可以抓取其他ROM，如<a> LineageOS 15.1 </a>或复活混音GSIs。我将这些线程链接如下。下载适合您的设备类型(大多数人使用ARM64)和分区类型的映像。如果你的设备支持无缝更新(这种设备的列表<a href="https://www.xda-developers.com/list-android-devices-seamless-updates/">可以在这里找到</a>，然后下载A/B镜像，否则下载A-only镜像。</li> </ol>

<p/><h4>为非正式支持高音的设备做准备</h4>

<ol> <li>解锁您的设备的引导加载程序。您在此采取的步骤因设备而异。我们在门户网站和论坛上都有许多指南供您阅读。只要在谷歌上快速搜索“XDA解锁引导程序”+你的设备名，你就会找到很多指南。</li> <li>通过闪烁本文中提到的帖子中链接的适当文件<a href="https://www.xda-developers.com/list-android-devices-project-treble-support/">，使您的设备高音兼容。你必须在闪现GSI之前做到这一点！</a></li> <li>将您选择的GSI下载到您的PC上。你可以刷新纯AOSP ROM，如phh-Treble，或者如果你喜欢更多的功能，你可以抓取<a> LineageOS 15.1 </a>或复活混音GSIs。我将这些线程链接如下。下载适合您的设备类型(大多数人使用ARM64)和分区类型的映像。如果你的设备支持无缝更新(这种设备的列表<a href="https://www.xda-developers.com/list-android-devices-seamless-updates/">可以在这里找到</a>，然后下载A/B镜像，否则下载A-only镜像。</li> </ol>

<p>以下步骤取决于您的设备是否有您可以使用的功能性TWRP。如果你的设备有TWRP，那么我们强烈建议你先安装它。我们在这里有一个<a href="https://www.xda-developers.com/how-to-install-twrp/">指南。</a></p>

<p/><h4>与TWRP一起闪现GSI</h4>

<ol> <li>在TWRP境内执行工厂重置。</li> <li>将GSI从您的PC传输到TWRP可以访问的设备内部存储器。</li> <li>点击“安装”</li> <li>将类型从“zip”更改为“image”</li> <li>找到并选择您下载的GSI。</li> <li>选择刷新到系统分区。</li> <li>完成后，重启你的设备。</li> </ol>

<p>希望你的设备能在几分钟的等待后启动。如果没有，请跳过以下部分，转到故障排除提示。</p>

<p/><h4>没有TWRP的闪光GSI</h4>

<ol> <li>在您的设备上执行出厂重置。您有两种选择:<ul> <li>打开手机上的设置应用，寻找恢复出厂设置选项。通常在与备份相关的设置下。</li> <li>在启动时使用按钮组合或在Android中启动时发出以下ADB命令来重新启动设备的股票恢复:<code>adb reboot recovery</code>。到达这里后，使用音量键进行导航，使用电源按钮选择恢复出厂设置选项。</li> </ul> </li> <li>一旦您的设备恢复出厂设置，在启动时使用按钮组合或在Android中启动时发出以下ADB命令，重新启动设备的引导加载程序:<code>adb reboot bootloader</code></li> <li>将您的设备连接到PC，在您下载所选GSI的同一目录中打开命令提示符或终端窗口。</li> <li>输入以下命令:<code>fastboot erase system</code></li> <li>按以下格式输入命令:<code>fastboot -u flash system name_of_system.img</code></li> <li>让图像闪烁，这可能需要几分钟时间。完成后，通过电源键或输入<code>fastboot reboot</code>手动重启设备。</li> </ol>

<p>希望你的设备能够启动到你选择的GSI。如果没有，这里有一些故障排除技巧。</p>

<p/><h4>故障排除提示</h4>

<ul> <li>在一些设备上，如谷歌像素2/2 XL T2，安卓验证启动(AVB)需要被禁用。你可以通过将<a href="https://drive.google.com/open?id=1ifnXCIdkqKnk_a1HII9RqQd5CVFWz1xR">这个镜像</a>刷新到vbmeta分区来实现(命令:<code>fastboot flash vbmeta name_of_vbmeta.img</code>)</li> <li>在<strong> OnePlus 6 </strong>上，你需要遵循一些<a href="https://forum.xda-developers.com/oneplus-6/how-to/treble-mistery-solved-developer-t3800716">特殊的闪烁指令</a>。</li> <li>dm-verity可能会阻止您的设备使用GSI启动。在这种情况下，请继续闪存Magisk，然后看看它是否启动。举例来说，我被告知这是Razer手机所必需的。</li> <li>作为最后的手段，您可以在引导加载程序中通过从命令提示符/终端窗口输入<code>fastboot -w</code>来尝试数据分区的完整格式(<strong>警告:这将清除所有的</strong>)。我不得不在我的华为设备上这样做，然后它才能工作。</li> </ul>

<hr/>

<h3 id="what-to-do-after-flashing-the-generic-system-image">刷新通用系统映像后要做什么</h3>
<p>默认情况下，没有任何应用程序来管理超级用户权限。你可以通过从谷歌Play商店安装phh的超级用户<a href="https://play.google.com/store/apps/details?id=me.phh.superuser">来解决这个问题。或者，你可以闪现</a><a href="https://forum.xda-developers.com/apps/magisk"> Magisk </a>或<a href="https://forum.xda-developers.com/apps/supersu">SuperSU</a>——由你决定。</p>

<p>接下来，如果你想进一步修改的话，你可以为主题或者<a href="https://www.xda-developers.com/xposed-framework-for-android-oreo-beta/">暴露的框架</a>安装<a href="https://www.xda-developers.com/custom-themes-android-oreo-substratum/">底层。Magisk存储库中有大量简洁的模块，您也可以尝试一下。LineageOS 15.1，尤其是复活混音已经提供了大量开箱即用的功能，所以我们不认为你真的需要修补大量额外的好东西，但选择是存在的。</a></p>

<p>现在，享受股票Android的世界！我们建议您关注<a href="https://forum.xda-developers.com/project-treble/trebleenabled-device-development">Treble-Enabled Device Development</a>论坛，了解有关您的ROM的任何更新。此外，请关注XDA门户网站，了解与Treble项目相关的所有最新进展。最好的方法是为<a href="https://www.xda-developers.com/tag/project-treble/">高音标签</a>设置一个馈送。</p>

<p>最后，请向<a href="https://github.com/phhusson/treble_experimentations/wiki"> Treble Experimentations wiki页面</a>投稿，这样其他人就会知道ROM的任何潜在问题(这样开发者就知道该修复什么！)</p>

 </div>


</div>    
</body>
</html>