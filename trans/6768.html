<html>
<head>
<title>Magisk now supports the Google Pixel 3 and Pixel 3a on Android Q</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Magisk现在支持Android Q上的谷歌Pixel 3和Pixel 3a</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/magisk-google-pixel-3-pixel-3a-android-q/#0001-01-01">https://www.xda-developers.com/magisk-google-pixel-3-pixel-3a-android-q/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>谷歌在三月份发布了第一个Android Q测试版，谷歌Pixel和谷歌Pixel 2很快就可以通过Magisk进行root访问。然而，谷歌Pixel 3不能植根于Android Q，因为Magisk的开发者XDA认识到开发者<a href="https://forum.xda-developers.com/member.php?u=4470081"> topjohnwu </a>需要弄清楚如何使用新的逻辑分区布局。随着他在苹果公司的新实习，topjohnwu在Magisk上工作的时间减少了，但这并没有阻止他在开发方面取得两项重大突破。在最新的Canary版本中，Magisk现在支持system-as-root，使应用程序更难检测root访问，并且还支持具有逻辑分区的设备，如Android Q上的Pixel 3和Pixel 3a XL系列。</p>

  
<p/><p><a href="https://forum.xda-developers.com/pixel-3"> <strong>谷歌Pixel 3论坛</strong> </a> <strong> <a href="https://forum.xda-developers.com/pixel-3-xl">谷歌Pixel 3 XL论坛</a> </strong></p>

<p/><p><strong> <a href="https://forum.xda-developers.com/pixel-3a">谷歌像素3a论坛</a> <a href="https://forum.xda-developers.com/pixel-3a-xl">谷歌像素3a XL论坛</a> </strong></p>

 
<h2 id="google-pixel-3-and-pixel-3a-logical-partition-support-on-android-q">Android Q上的Google Pixel 3和Pixel 3a逻辑分区支持</h2>
<p>为了帮助开发者在现有设备上测试AOSP版本的Android，谷歌发布了通用系统映像(GSI)，可以在Project Treble兼容的设备上启动(任何使用Android 9 Pie或更高版本启动的设备)。)安装GSI需要解锁引导加载程序，这可能并非在所有设备上都可行，并且在擦除用户数据后在快速引导上刷新系统映像。在Android Q中，谷歌引入了一个名为<a href="https://www.xda-developers.com/android-q-dynamic-system-updates-project-treble/">动态系统更新</a>的新功能，该功能允许开发者在不解锁引导加载程序或擦除数据的情况下启动GSI。为了支持动态系统更新，设备需要具有可以动态调整大小的逻辑分区，以便为GSI安装腾出空间。谷歌Pixel 3、谷歌Pixel 3 XL、谷歌Pixel 3a和谷歌Pixel 3a XL在Android Q betas上有逻辑分区，尽管只有Pixel 3和Pixel 3 XL支持DSU。尽管如此，正是由于分区结构的这种彻底改变，Magisk才无法工作。</p>

<p>当topjohnwu下定决心，什么都不能阻止他实现root权限。就在前几天，他宣布他已经成功地将他的Pixel 3 XL植根于Android Q beta 4。他的提交描述<a href="https://github.com/topjohnwu/Magisk/commit/f1112fdf3719c1ed2af7c2bc1d1d4dc3f67bf292">这里</a>解释了他如何实现逻辑分区支持的技术细节，但重要的是Magisk现在可以安装在有或没有逻辑分区的设备上。</p>

 


<p class="ad-odd"> </p>


<h2 id="system-as-root-support">系统根支持</h2>
<p>对于带有<a href="https://www.xda-developers.com/how-a-b-partitions-and-seamless-updates-affect-custom-development-on-xda/"> A/B双分区</a>的设备，系统分区被挂载为根目录(/)，但是没有A/B双分区的设备将系统分区挂载在/system。这使得纯系统OTA在非A/B设备上是不可能的，因为ramdisk中需要更新的文件位于引导分区中。这就是为什么，为了使Android Pie和更高版本中的纯系统OTA成为可能，Google要求所有使用Android Pie的设备都支持system-as-root分区布局。在system-as-root布局中，ramdisk映像被合并到系统映像中，系统映像作为rootfs挂载。</p>

<p>由于Google引入了system-as-root，根设备的<a href="https://twitter.com/topjohnwu/status/1143799584801447937">解决方案</a>是将system-as-root恢复到旧的分区“initramfs rootfs”布局。这种<a href="https://twitter.com/topjohnwu/status/1143799588005928960">在Android 7.1到Android 9 Pie上运行</a>很好，因为Android有对这种旧布局的传统支持，但Android Q完全<a href="https://twitter.com/topjohnwu/status/1143799588744073218">取消了</a>支持，因为system-as-root现在对所有设备都是强制性的，甚至对那些正在更新到Android Q的设备也是如此。Magisk的以前版本仍然工作，这要感谢一些“非常讨厌的黑客”，但topjohnwu对那个解决方案不满意，所以为了正确支持system-as-root，他<a href="https://twitter.com/topjohnwu/status/1143799587024412672">引入了</a>“MagiskInit”</p>

<p>正确支持系统作为根分区布局的一个好的副作用是，根检测的一个潜在途径已经被压制。正如topjohnwu亲切地向我解释的那样，旧的“恢复到initramfs rootfs”方法很容易被应用程序检测到，因为Magisk会将系统挂载到“/system_root”并将挂载“/system_root/system”绑定到“/system”应用程序要检测根的存在，只需检查“/system_root”是否存在，或者“/”是否为“rootfs”然而，目前还不清楚是否有任何应用程序真正利用这一点来检测root。尽管如此，安全总比后悔好。</p>
<p class="ad-even"> </p>


<h2 id="miscellaneous-changes">杂项变更</h2>
<p>Android Q为Android应用程序生命周期引入了对称为“<a href="https://github.com/aosp-mirror/platform_frameworks_base/commit/cffbf1c9b4d6ea7fa58dba77073092f8f4571a00">囊胚池</a>的东西的支持。如果启用了新的“进程池”功能，MagiskHide】无法检测应用程序以隐藏root访问。最新的Canary版本现在支持这个特性。根据topjohnwu的说法:“为了正确地支持Q中引入的新的囊胚池优化，我重写了一大块用于进程监控的ptracing逻辑。”</p>

<hr/>

<p>如果你在Android Q beta上有Pixel 3、Pixel 3 XL、Pixel 3a或Pixel 3a XL，请尝试最新的Magisk Canary版本，并让我们知道你是否成功地根化了你的设备。</p>

<p/><p><a href="https://forum.xda-developers.com/apps/magisk/dev-magisk-canary-channel-bleeding-edge-t3839337"> <strong> Magisk金丝雀频道</strong>T3】</a></p>

 </div>


</div>    
</body>
</html>