<html>
<head>
<title>Exclusive: 3 of Android 11's best features won't be on every device</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>独家:Android 11的3个最好的功能不会出现在每台设备上</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/android-11-best-features-not-required/#0001-01-01">https://www.xda-developers.com/android-11-best-features-not-required/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>谷歌每年都会发布新版本的Android操作系统。谷歌在2月份发布了第一个Android 11开发者预览版，随后在过去的几个月里发布了第二、第三和第四个开发者预览版。本月早些时候，谷歌发布了第一个Android 11测试版(T1 ),并深入讨论了用户享受和开发者实现的最佳功能。然而，我们现在已经了解到，Android 11中的三个顶级功能不会在每个Android设备上可用。</p>

  
<p>为了理解这是如何可能的，我们必须简要解释一下Android操作系统是如何从谷歌分发给智能手机设备制造商的。Android是一个在Apache 2.0下授权的<a href="https://android.googlesource.com/">开源操作系统</a>，这意味着任何人，从独立开发者到大公司，都可以在自己的设备上自由修改和分发该操作系统。谷歌为Android 11推出的大多数新操作系统功能都将是Android开源项目(AOSP)的一部分，智能手机设备制造商基于该项目开发自己的软件，但正如我之前提到的，Apache 2.0许可证允许任何人根据自己的意愿修改软件。为了保持Android设备之间API和平台行为的一致性，谷歌将谷歌移动服务(包括谷歌Play商店和Google Play服务等应用程序和框架)的分发与许可协议捆绑在一起，强制设备遵守谷歌“<a href="https://source.android.com/compatibility/overview"> Android兼容性计划</a>”下的规则(以及其他要求)。Android兼容性计划由多个自动化测试套件和Android <a href="https://source.android.com/compatibility/cdd">兼容性定义文档</a> (CDD)中列举的一组规则组成。</p>

<p>在CDD中，谷歌列出了设备制造商“必须”实现、仅“强烈建议”实现或“不应该”实现的软件和硬件功能。如果一个功能被列为“必须”实现，那么设备制造商必须添加该功能，否则他们不能在自己的设备上发布谷歌应用程序。如果一个功能被列为“不应该”实现，那么设备制造商就不能添加该功能，或者他们不能捆绑谷歌应用程序。最后，如果一个特性被列为“强烈推荐”，那么它取决于设备制造商是否想要实现这个特性。CDD是一个不断变化的文档，甚至在每年公开发布新的Android版本后发布之前也是如此。谷歌经常更新文档以删除功能，更改语言以更加清晰，并根据合作伙伴的反馈放松要求。然而，一旦谷歌为某个特定的Android版本公开了CDD，那些要求将会为运行该Android操作系统版本的谷歌认证设备而定。</p>

<p>Android 11 CDD要到今年晚些时候才会公开，可能是在9月初。然而，开发者@ <a href="https://twitter.com/deletescape"> deletescape </a>分享了一份预发布文件，详细介绍了CDD的变化，让我们提前了解了谷歌如何在整个生态系统中塑造Android 11。CDD的60多项变化中的绝大多数对用户来说都不是很有趣——它们描述了设备制造商必须如何实现某些API、声明某些功能以及实现某些内核功能。然而，CDD的3个变化引起了我们的注意，因为它们涉及到Android 11中一些最有趣的功能。这是我们发现的。</p>

<p><strong>设备控制</strong></p>



<p>设备控制是Android 11中的一项功能，允许智能家居自动化控制显示在电源菜单中。你可以关掉灯，打开车库门，启动吸尘器，改变家里的温度，以及做更多事情，而无需打开十几个不同的智能家居应用程序。谷歌增加了API，智能家居应用程序的开发者可以使用这些API来显示电源菜单中的控件。我们认为这是一个很好的功能，最终将您的智能手机带入智能家居。不幸的是，没有要求原始设备制造商实际实施它。如果OEM认为该功能很差劲，或者他们想走不同的路线(例如只允许来自他们自己生态系统中的设备的智能家居控制)，那么他们可以简单地禁用对设备控制的支持。</p>

<p>当谷歌在2020年2月25日首次将设备控制添加到CDD时，他们通过在第2.2.3节-手持软件要求中添加“必须”要求来强制将其包含在内。然而，2020年5月20日，谷歌更新了文本，删除了提议的“必须”。新的第3.8.16节-设备控制概述了必须如何实现该功能，但实际上并不要求首先实现它！我们希望原始设备制造商不会禁用这个漂亮的功能，但我们没有办法知道他们是否禁用了它，直到他们准备好推出他们自己的基于Android 11的Android版本，这要到几个月后才会发生。</p>

<section class="emaki-custom-block emaki-custom-expandable"><div class="emaki-custom expandable" id="custom_block_8"><h3 id="proposed-section-3-8-16-new---device-controls-updated-5-20-2020">提议的第3.8.16节(新)-装置控制(2020年5月20日更新)</h3><p><strong> 3.8.16设备控制</strong></p><p>Android包括ControlsProviderService和Control APIs，允许开发人员发布设备控件，以便为用户提供快速状态和操作。</p><p><strong>3.8.16.1设备控制用户可见性</strong></p><p>如果设备实施设备控制，则它们:</p><ul> <li>[C-1-1]必须报告Android . software . controls . feature标志为真</li> <li>[C-1-2]必须通过Android . service . controls . controls providerservice和Android . service . controls . control API，为用户提供能够从第三方应用程序注册的控件中添加、编辑、选择和操作用户收藏夹的功能。</li> <li>[C-1-3]必须在启动器的三次交互内提供对该用户启示的访问</li> <li>[C-1-4]必须在此用户启示中准确呈现通过Android . service . controls . controls providerservice API提供控件的每个第三方应用程序的名称和图标，以及Android . service . controls . controls API提供的任何指定图标、状态文本、设备类型、名称、结构、区域、自定义颜色和副标题</li> </ul><p>相反，如果设备实现不实现这样的控制，那么它们</p><ul> <li>[C-2-1]必须为ControlsProviderService和控制API报告Null。</li> </ul> </div></section>
<p><strong>通知中的对话</strong></p>
<div class="body-img portrait"><div class="responsive-img image-expandable img-article-item-portrait" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif" data-modal-id="single-image-modal" data-modal-container-id="single-image-modal-container" data-img-caption="&quot;Conversations in Android 11. Source: Google&quot;">
 
<figure> <picture>  <source media="(min-width: 1024px)" sizes="750px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif?q=50&amp;fit=crop&amp;dpr=1.5"/> <source media="(min-width: 768px)" sizes="750px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif?q=50&amp;fit=crop&amp;dpr=1.5"/> <source media="(min-width: 481px)" sizes="600px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif?q=50&amp;fit=crop&amp;dpr=1.5"/> <source media="(min-width: 0px)" sizes="360px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif?q=50&amp;fit=crop&amp;dpr=1.5"/> <img class="lazyload" alt="" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif" src="../Images/4cca62f628c5a1d2bc1ff607e87e3247.png" data-original-src="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/06/Android11_Conversations.gif"/> </picture> <figcaption class="body-img-caption">Conversations in Android 11. Source: Google</figcaption> </figure> </div>


 </div>


<p>与iOS相比，Android的最大优势之一是前者处理通知的方式。随着“对话”的引入，这种可用性差距在Android 11中将会变得更大。在Android 11中，来自消息应用的通知被分组在一起，并显示在通知面板中的独立部分，位于大多数其他通知的上方。这使您可以快速查看和回复邮件，而不必滚动浏览所有其他待处理的通知。不幸的是，这种通知的巧妙变化可能并不适用于所有设备。谷歌让原始设备制造商选择他们是否想要“在非对话通知之前分组并显示对话通知。”原始设备制造商经常定制通知面板，所以谷歌在这里给原始设备制造商一个选择也就不足为奇了。尽管如此，令人遗憾的是，谷歌没有选择在Android 11中加强通知的一致性。</p>

<section class="emaki-custom-block emaki-custom-expandable"><div class="emaki-custom expandable" id="custom_block_12"><h3 id="proposed-changes-to-section-3-8-3-1---presentation-of-notifications-updated-4-08-2020">对3.8.3.1部分-通知提交的拟议更改(2020年8月4日更新)</h3><p>如果设备实现允许第三方应用通知用户值得注意的事件，它们:</p><p>...</p><p>Android R引入了对对话通知的支持，这是一种使用NotificationManager的通知。MessageStyle并提供已发布人员的快捷方式ID。</p><p>设备实现包括:</p><ul> <li>[H-SR]强烈建议在非对话通知之前对对话通知进行分组和显示，但正在进行的前台服务通知和重要性:高通知除外。</li> </ul><p>如果对话通知被分组到单独的部分，设备实现</p><ul> <li>[H-1-8]必须在非对话通知之前显示对话通知，但正在进行的前台服务通知和重要性:高通知除外。</li> </ul><p>设备实现包括:</p><ul> <li>[H-SR]强烈建议从对话通知中提供对以下操作的访问:如果应用程序提供气泡所需的数据，则将此对话显示为气泡</li> </ul><p>AOSP实现通过默认的系统UI、设置和启动程序来满足这些要求。</p> </div></section>
<p><strong>身份证-移动驾照</strong></p>

<p>最后，我最感兴趣的特性之一是IdentityCredential API。<a href="https://www.xda-developers.com/google-android-digital-drivers-license/">正如我们去年详细介绍的</a>，IdentityCredential API旨在允许应用程序在设备上存储身份文档，如移动驾驶执照。世界上有几个国家(和美国的一些州)已经允许他们的公民将驾照存储在移动应用程序中。然而，谷歌正在努力通过将数据离线存储在安全的环境中来提高安全性。</p>
<div class="body-img landscape"><div class="responsive-img image-expandable img-article-item" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg" data-modal-id="single-image-modal" data-modal-container-id="single-image-modal-container" data-img-caption="&quot;A sample image of a digital driver's license accessed through the LA Wallet app. Source: Envoc&quot;">
 
<figure> <picture>  <source media="(min-width: 1024px)" sizes="1500px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg?q=50&amp;fit=crop&amp;w=1500&amp;dpr=1.5"/> <source media="(min-width: 768px)" sizes="943px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg?q=50&amp;fit=crop&amp;w=943&amp;dpr=1.5"/> <source media="(min-width: 481px)" sizes="767px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg?q=50&amp;fit=crop&amp;w=767&amp;dpr=1.5"/> <source media="(min-width: 0px)" sizes="480px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg?q=50&amp;fit=crop&amp;w=480&amp;dpr=1.5"/> <img class="lazyload" alt="" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg" src="../Images/d43ba2ce0cf0045d9b35518d04325b52.png" data-original-src="https://static1.xdaimages.com/wordpress/wp-content/uploads/2020/03/LA-Wallet-Digital-Drivers-License-1024x544.jpeg"/> </picture> <figcaption class="body-img-caption">A sample image of a digital driver's license accessed through the LA Wallet app. Source: Envoc</figcaption> </figure> </div>


 </div>


<p>Android 11的源代码包括IdentityCredential API(开发者将调用该API在手机的安全环境中存储身份文档)和IdentityCredential HAL(与手机的安全环境接口)，但OEM厂商不需要实现它们。当谷歌于2020年1月10日首次提出将IdentityCredential纳入CDD时，他们将其列为一项要求。然而，他们在2020年3月18日放宽了这一要求，现在只强烈建议OEM厂商支持这一功能。我们对Google放松这一要求并不感到惊讶——添加影响可信执行环境的更改将需要原始设备制造商的努力来实现。原始设备制造商可能只是需要更多的时间来为这一变化做准备。然而，对于用户来说，这意味着不能保证你的特定Android 11智能手机将支持在手机的安全环境中安全存储移动驾照。</p>

<p>我们应该注意到，没有技术限制阻止在Android 11设备中广泛采用IdentityCredential系统。实现身份认证系统的要求之一是设备具有可信执行环境(TEE)或专用安全处理器，其中“可信应用程序”与存储的身份文档进行交互。自Android 7.0 Nougat以来，谷歌要求所有现代Android设备支持“隔离执行环境”(根据<a href="https://source.android.com/compatibility/android-cdd#2_2_5_security_model">第2.2.5节-CDD的安全模型</a>)。配备ARM处理器的设备通常采用ARM的<a href="https://developer.arm.com/ip-products/security-ip/trustzone"> TrustZone </a> TEE，谷歌提供运行在TrustZone上的<a href="https://source.android.com/security/trusty"> Trusty OS </a>。TEE的存在足以支持身份认证系统，尽管如果证书存储在嵌入式安全CPU(如一些高通骁龙处理器的<a href="https://www.xda-developers.com/qualcomm-snapdragon-865-spu-dual-sim-dual-standby-drivers-licenses-android-11/">安全处理单元)或分立的安全CPU(如</a><a href="https://www.xda-developers.com/google-pixel-3-titan-m-security/">谷歌的Titan M </a>或<a href="https://www.xda-developers.com/samsung-sell-galaxy-s20-hardware-security-chip/">三星的新安全芯片</a>)中会更安全。值得注意的是，具有分立安全CPU的设备也能够支持IdentityCredential系统的“直接访问模式”功能，这将允许用户即使在设备剩余电量不足以启动主操作系统的情况下也能调出他们的身份文档。</p>

<section class="emaki-custom-block emaki-custom-expandable"><div class="emaki-custom expandable" id="custom_block_18"><h3 id="proposed-section-9-11-3-new---identity-credential-updated-3-18-2020">提议的第9.11.3节(新)-身份证明(2020年3月18日更新)</h3><p>身份凭证系统允许应用程序开发人员存储和检索用户身份文档。</p><p>设备实现:</p><ul> <li>强烈建议[C-SR]实施身份凭证系统。</li> </ul><p>如果设备实现实现了身份凭证系统，则它们:</p><ul> <li>[C-0-1]必须为<a href="https://developer.android.com/reference/android/security/identity/IdentityCredentialStore#getInstance%28android.content.Context%29">IdentityCredentialStore # getInstance()</a>方法返回非空值。</li> <li>[C-0-2]必须使用代码实现“Android . security . identity . *”API，以便与在可信执行环境(TEE)或专用安全处理器上运行的可信应用程序进行通信。必须实现可信应用，使得身份凭证系统的<a href="https://en.wikipedia.org/wiki/Trusted_computing_base">可信计算基础</a>不包括Android操作系统。</li> </ul> </div></section>
<p>谷歌还在开发IdentityCredential Jetpack库，以使开发者更容易在Android上添加对安全存储身份文档的支持，但真正的挑战将是让政府授权应用程序使用该API来安全存储政府id。据<a href="https://www.engadget.com/south-koreans-can-now-store-their-driving-license-on-their-smartphones-094503272.html"> <em> Engadget </em> </a>报道，韩国刚刚推出了在手机应用程序中存储驾照的支持，因此我们开始看到这项技术的接受度有所上升。就我个人而言，我很期待看到这一天的到来，因为这意味着我出门时可以少带一样东西。</p>

<hr/>

<p>我们获得的文件列出了CDD的变更日期。最新的更改是在2020年6月10日进行的，这意味着我们拥有的文档是最新的。谷歌可能会食言，在Android 11公开发布之前再次提出所有要求，但我们怀疑谷歌会突然让CDD变得更加严格。由于原始设备制造商的反馈，这些变化可能会放松，如果他们还没有计划这样做，他们将不得不回去实现这些功能。这需要时间、精力和金钱，这只会进一步推迟面向非谷歌设备的Android 11的发布。尽管如此，如果谷歌确实再次要求这些功能，我们将在XDA门户网站上发布更新。</p>

 </div>


</div>    
</body>
</html>