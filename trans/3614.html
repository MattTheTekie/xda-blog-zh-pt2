<html>
<head>
<title>How to Enable System-Wide Immersive Mode without Root</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在没有Root用户的情况下启用全系统沉浸式模式</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/how-to-enable-system-wide-immersive-mode-without-root/#0001-01-01">https://www.xda-developers.com/how-to-enable-system-wide-immersive-mode-without-root/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>随着手机屏幕变得越来越大，有时我们希望隐藏状态栏和导航栏，这样我们就可以使用整个清晰、漂亮的高清屏幕来查看我们的内容。</p>

  
<p>从Android 4.4开始，应用程序可以实现<a href="https://developer.android.com/training/system-ui/immersive.html">沉浸式模式</a>，真正为最终用户带来全屏体验。不幸的是，谷歌和原始设备制造商从来没有让用户手动控制何时启用沉浸式模式。一个名为<a href="https://play.google.com/store/apps/details?id=com.gmd.immersive&amp;hl=en"> GMD全屏沉浸式模式</a>的第三方应用程序已经提供了几年的解决方案，但使用这个应用程序的最大问题是它会破坏软键盘。</p>

<p>用户使用ADB命令触发系统范围的沉浸式模式已经有一段时间了，但多年来人们一直认为，从ADB终端上拔下插头时使用该命令需要root访问权限。然而，去年年底用户发现，如果应用程序有一定的权限，某些ADB命令实际上可以在没有root访问权限的设备<strong>上触发。这意味着你可以根据需要<strong>启用全系统沉浸式模式</strong><strong/>。例如，你可以创建一个牛轧糖磁贴来切换沉浸式模式，甚至可以基于每个应用程序设置沉浸式模式。</strong></p>

<hr/>


<h2 id="toggle-immersive-mode-without-root">切换无根的沉浸式模式</h2>
<p class="w-rich w-youtube" id="VbjInuhdRt0">  </p>


<p>正如你在上面的视频中看到的，我已经创建了一个牛轧糖磁贴，当我按下它时，它会切换沉浸式模式。这是在我的非root华为Mate 9上，但它应该可以在几乎所有Android 4.4+设备上工作。你只需要两个应用程序就能完成这项工作:<a href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm&amp;hl=en"> Tasker </a>和<a href="https://joaoapps.com/beta-testing/"> AutoTools Beta </a>。如果你想用这个做一块牛轧糖砖，你还需要安装<a href="https://play.google.com/store/apps/details?id=com.joaomgcd.autonotification&amp;hl=en">自动通知</a>，但这不是必需的。</p>

<p>一旦您安装了这两个应用程序，您将需要授予自动工具<strong> WRITE_SECURE_SETTINGS </strong>权限，以便能够切换沉浸式模式(在其他令人敬畏的设置中，我们将在稍后介绍)。这是因为沉浸式模式的命令是在<strong>设置下定义的。Global  </strong>类，尽管该命令的确切语法隐藏在AOSP。我们将首先讨论如何向自动工具授予必要的权限，然后讨论如何在Tasker中使用该命令。</p>

<hr/>


<p>在Android的权限管理系统下，应用程序在清单文件中定义它们希望被授予的权限。然后，用户可以授予或拒绝安装权限(前棉花糖)或按需权限(棉花糖+)。但是，有些权限是应用程序即使在清单中请求也不能被授予的，比如<a href="https://developer.android.com/reference/android/Manifest.permission.html#WRITE_SECURE_SETTINGS"> WRITE_SECURE_SETTINGS </a>。这是因为授予任何应用程序如此强大的权限都会让该应用程序对您的设备进行大量控制。</p>

<p>但是有一个解决方法，我们可以使用它来授予任何我们想要的应用程序WRITE_SECURE_SETTINGS权限。通过使用ADB的<a href="https://developer.android.com/studio/command-line/adb.html#pm">包管理器(pm) </a>工具，我们可以向任何我们想要的应用程序授予任何权限(假设应用程序在清单文件中请求该权限)。</p>

<p>你需要做的第一件事是<a href="https://www.xda-developers.com/google-releases-separate-adb-and-fastboot-binary-downloads/">将ADB二进制文件</a>安装到你的电脑上，然后为你的设备安装<a href="https://developer.android.com/studio/run/oem-usb.html">正确的驱动程序。然后，在开发者选项中启用USB调试(进入设置- &gt;关于手机，如果你还没有的话，点击7次内部版本号)，将手机连接到电脑上。最后，打开终端后，发送以下命令:</a></p>

<p><code>adb shell pm grant com.joaomgcd.autotools android.permission.WRITE_SECURE_SETTINGS</code></p>

<p>现在，自动工具将能够更改您设备上的任何全局、安全或系统设置。有各种方法可以使用这些设置，每个类别中的可用设置列表完全取决于您的设备和软件版本，但这一讨论将在其他时间进行。无论如何，我们将继续向您展示如何使用自动工具来切换沉浸式模式。</p>

<hr/>

<h3 id="using-tasker-to-toggle-immersive-mode-via-nougat-tile">使用Tasker通过牛轧糖磁贴切换沉浸式模式</h3>


<p>通过磁贴切换沉浸式模式显然需要Android牛轧糖，所以如果你没有牛轧糖，那么跳过这一部分，了解如何在每个应用程序的基础上切换它。如果您还没有，请从谷歌Play商店下载AutoNotification并授予其通知访问权限。这个Tasker插件是我们将用来制作自己的定制通知磁贴的。</p>

<p>这是对熟悉Tasker的人的简介描述。如果你对Tasker不太熟悉，请继续阅读逐步说明。</p>



<section class="emaki-custom-block emaki-custom-expandable"><div class="emaki-custom expandable" id="custom_block_21"><h3 id="nougat-tile-immersive-mode-toggle">牛轧糖瓷砖沉浸式模式切换</h3><pre> <code class="hljs javascript">Profile: Toggle Immersive Mode (30)<br/>Event: AutoNotification [ Configuration:Event Behaviour<br/>Filter: immersivemode ]<br/>Enter: Immersive Mode (33)<br/>A1: AutoNotification Tiles [ Configuration:Tile: 1<br/>Command: immersivemode<br/>Label: Immersive mode<br/>Icon: <span class="hljs-regexp">/storage/</span>emulated/<span class="hljs-number">0</span>/Tasker/immersive.png<br/><span class="hljs-selector-tag">State</span>: 999 <span class="hljs-selector-tag">Timeout</span> (<span class="hljs-selector-tag">Seconds</span>)<span class="hljs-selector-pseudo">:60</span> ]<br/><span class="hljs-selector-tag">A2</span>: <span class="hljs-selector-tag">AutoTools</span> <span class="hljs-selector-tag">Secure</span> <span class="hljs-selector-tag">Settings</span> <span class="hljs-selector-attr">[ Configuration:Immersive Mode: Toggle Timeout (Seconds):60 ]</span></code> </pre> </div></section>
<p>打开Tasker，按下右下角的<strong> + </strong>按钮。创建一个<strong>事件</strong>上下文并选择<strong>插件- &gt;自动通知。</strong>点击铅笔图标打开自动通知的配置页面。在<strong>命令过滤器</strong>下输入<strong> immersivemode </strong>。这就是当我们点击一块牛轧糖砖时发出的确切命令。</p>

<p>现在创建一个附加到这个概要文件的新任务(使用任何名称)，第一个操作是进入<strong>插件- &gt;自动通知- &gt;图块</strong>。对于图块编号，选择第一个图块。对于<strong>命令</strong>，输入<strong>沉浸模式</strong>完全按照写的。标签将显示在磁贴下，因此将其命名为“沉浸式模式”对于<strong>图标</strong>，将我在本节开始时附加的图标保存到您的内部存储器中并使用。最后对于<strong>状态</strong>选择<strong>切换激活/非激活。</strong></p>





<p>完成后，运行该任务一次(按下任务创建屏幕左下角的播放按钮),以便填充图块。现在，一旦您展开可用通知窗口列表，您应该会看到新的沉浸式模式切换。</p>





<hr/>

<h3 id="using-tasker-to-toggle-immersive-mode-on-a-per-app-basis">使用Tasker在每个应用程序的基础上切换沉浸模式</h3>


<p>在每个应用程序的基础上切换沉浸式模式非常简单，我们需要做的就是在Tasker中创建一个应用程序上下文，当应用程序启动或关闭时，它将触发，当它这样做时，沉浸式模式将被切换。为了让Tasker监控应用程序，您需要启用它的<strong>辅助功能服务</strong>。</p>

<p>这是对熟悉Tasker的人的简介描述。如果你对Tasker不太熟悉，请继续阅读逐步说明。</p>

<section class="emaki-custom-block emaki-custom-expandable"><div class="emaki-custom expandable" id="custom_block_32"><h3 id="per-app-immersive-mode">每应用沉浸式模式</h3><pre> <code class="hljs css">Profile: Per-App Immersive Mode (192)<br/> Application: Chrome or XDA Labs<br/>Enter: Anon (199)<br/> <span class="hljs-selector-tag">A1</span>: <span class="hljs-selector-tag">AutoTools</span> <span class="hljs-selector-tag">Secure</span> <span class="hljs-selector-tag">Settings</span> <span class="hljs-selector-attr">[ Configuration:Immersive Mode: Toggle Timeout (Seconds):60 ]</span> <br/><br/><span class="hljs-keyword">Exit</span>: Anon (<span class="hljs-number">204</span>)<br/> <span class="hljs-selector-tag">A1</span>: <span class="hljs-selector-tag">AutoTools</span> <span class="hljs-selector-tag">Secure</span> <span class="hljs-selector-tag">Settings</span> <span class="hljs-selector-attr">[ Configuration:Immersive Mode: Toggle Timeout (Seconds):60 ]</span></code> </pre> </div></section>
<p>您首先要打开Tasker，因为我们将创建一个配置文件，以便在某些应用程序打开时启动沉浸式模式。打开Tasker，按右下角的<strong> + </strong>按钮，创建一个新的个人资料。对于上下文类型，选择<strong>应用</strong>，并选择您希望沉浸式模式处于活动状态的所有应用。</p>

<p>完成后，按back，Tasker会要求您创建一个任务。不需要命名任务，所以只需按下复选标记就可以开始创建任务。一旦进入任务创建屏幕，您只需要添加一个操作。按下底部的<strong> + </strong>按钮，进入<strong>插件- &gt;自动工具- &gt;安全设置</strong>。按铅笔图标配置自动工具。在这里，转到<strong>显示屏</strong>，然后点击<strong>沉浸式模式</strong>，选择<strong>切换</strong></p>





<p>我们还需要做最后一件事，那就是在退出应用程序时禁用沉浸式模式。回到Tasker的主屏幕，在你刚刚创建的任务上长按，这样你就可以创建一个<strong>退出任务</strong>。当您创建一个退出任务时，只需添加您在第一个任务中添加的相同动作——这将切换沉浸式模式。</p>

<hr/>

<h3 id="fine-tuning-immersive-mode">微调沉浸式模式</h3>
<p>正如我之前提到的，强制沉浸式模式可用的确切命令可以从AOSP 收集<a href="https://android.googlesource.com/platform/frameworks/base.git/+/master/services/core/java/com/android/server/policy/PolicyControl.java">。通过发出以下命令之一，您可以将沉浸式模式设置为仅隐藏通知栏或仅隐藏导航栏:</a></p>

<p><code>settings put global policy_control immersive.status=*</code></p>

<p>设置将全局策略控制融入其中。navigation=*</p>

<p>当然，AutoTools实际上并不允许您像这样直接发送shell命令，而是使用它的接口发送命令。只需在AutoTools安全设置中选择“自定义设置”，将设置类型设置为“全局”，将“输入类型”设置为“字符串”，对于名称，您必须输入“policy _ control immersive . status = *”或“policy _ control immersive . navigation = *”。如果您更喜欢沉浸式模式，隐藏状态栏或导航栏，您可以使用此命令来代替我们用于Nougat Tile或每个应用程序控件的命令。</p>

<hr/>
<p class="ad-odd"> </p>


<h2 id="download-and-import-to-tasker">下载并导入Tasker</h2>
<p>一如既往，我们提供了脚本的XML文件，您可以下载和导入。只需从下面的链接下载文件，并将其保存在您的内部存储的任何地方。打开Tasker，在首选项中禁用初学者模式。然后，回到主屏幕，长按顶部的“个人资料”标签。您应该会看到一个弹出窗口，其中一个选项是“导入”点击它，浏览到保存. prf.xml文件的位置，并选择要导入的文件。</p>

<p>如果您选择导入通知磁贴1，请确保将沉浸式模式图标保存为Immersive，并将其保存到/sdcard/Tasker。如果您选择导入每个应用程序的配置文件，那么请确保您进入并自定义它将触发的应用程序，因为我的示例设置为仅在使用Chrome或XDA实验室时触发。</p>

<p><a href="https://www.androidfilehost.com/?fid=457095661767138543"> <strong>下载通知平铺沉浸式模式切换</strong> </a></p>

<p><a href="https://www.androidfilehost.com/?fid=673368273298932602"> <strong>下载每个应用的沉浸式模式切换配置文件</strong> </a></p>

<p>我们希望这个提示对你有用。如果这对你有用，请在下面的评论中告诉我们！</p>

 </div>


</div>    
</body>
</html>