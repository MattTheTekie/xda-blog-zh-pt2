# 弗兰西斯科·佛朗哥从佛朗哥内核采访第 1 部分

> 原文：<https://www.xda-developers.com/interview-francisco-franco-kernel-1/>

我最近有幸采访了有史以来最受欢迎的 Android 内核之一 Franco 内核背后的人。目前，该内核可用于许多不同的设备，包括各种 Nexus &一加设备和谷歌 Pixel / Pixel XL。

在这一部分，我们将谈论弗兰西斯科·佛朗哥的内核开发之旅，以及他对 Android 这些年来所经历的变化的看法。

* * *

我是 XDA 的亚当·康威，来采访 Franco 内核的开发者弗兰西斯科·佛朗哥！你想介绍一下自己吗？

当然，我的名字是弗朗西斯科，就像你刚才说的，我想我已经在 XDA 呆了一百万年了！做了各种各样的事情。内核、[应用](https://play.google.com/store/apps/dev?id=8270010790606670648&hl=en)，最近我在内核上有所松懈，因为过一段时间后它会变得令人厌倦，但我仍然在我的大多数设备上全力以赴。

好吧，我想很多人会熟悉你的作品，但很多人不会熟悉作品背后的真实人物。所以我想你在内核之前真的有任何经验吗？比如任何计算机科学学位之类的？

我一直对电脑充满热情，就像成长中的任何孩子一样。在我 18 岁以后，我决定像其他人一样去上大学，我想我会选择计算机科学之类的课程，但是一年以后，我发现那并不是我真正热爱的。那一年后，我的期望开始降低，因为只有空谈没有行动，我开始感到厌倦——不是因为我比任何人都好，我只是一般——而是实际的训练并不完全是我想要的。所以我和我的父母谈了谈，他们意识到我对此并不开心。2010 年圣诞节期间，我得到了我的第一部安卓手机。一个 LG P500，那是一个预算手机，很便宜，但是我知道它运行的是 Linux，我大学最喜欢的学科是计算机架构什么的，操作系统。我们学了一点 shell，谈了一点 Linux 内核，内核的一部分是什么，内核中的所有连接，以及实际的操作系统，这对我来说是*迷人的*。然后我开始和一个朋友一起为我的旧笔记本电脑重建 Linux 内核。这样做的时候，我们的笔记本电脑崩溃了 100 次，但是我们在这个过程中学到了很多。然后我开始玩我的 LG，我想我做的第一件事是试图推动更多的性能，因为那台设备实际上相当糟糕。因此，我能做的最好的事情就是仔细查看实际内存管理的标准 Linux 内核参数，并尝试找到比现有参数更好的参数。那时我有一点点快乐。

我想我之前在之前的采访中没有提到过这一点，但当时该设备使用的是一个名为 YAFFS 的旧文件系统，这意味着另一个闪存文件系统，但当我们试图像 RAM 支持的交换磁盘一样安装时，它非常慢，所以，我不记得具体情况了，但我们做了各种不同的实验，最终我们将 Dalvik 安装在内存 RAM 上，每次重新启动都必须重建，因为正如您所知，RAM 在每次重新启动时都会消失。但是它使得打开应用程序和运行基准测试变得非常快，所以我们很高兴。所以在那之后，我开始更深入一点，尝试为设备编译 LG 的内核源代码，我做出了各种糟糕的判断和各种错误——Wi-Fi 网络，等等——你可以从没有经验的人那里想象到的一切。这很有趣，我学到了很多。我想在这样做了一年或六个月之后，我变得更专注了，我也更清楚我需要什么来获得下载。这是我们最终都想要的。在那之后，我设法获得了一些捐款，并转向其他设备。我猜是 Nexus S，然后是 Galaxy Nexus，然后在那段时间之后，我设法推出了我的第一个应用程序。我想我已经很幸运了，我已经有能力为自己购买新的设备，从那以后它就爆炸了。所以我想说到底，我应该感谢的不是 XDA，而是 XDA 为我们提供的平台。

***及其背后的社区。***

是的，我指的是平台，也就是社区和实际的论坛。对于任何听的人来说，这不是一个付费的赞助商或任何东西，我没有被付费来说这些，这只是事实！

***没有视频，老百姓没看到枪指着你的头，没事的。***

哈哈哈，是啊，但是有人会说我是被雇来说这些的，所以我就直说了！但是，是的，是的，这是一个了不起的平台，让我建立了很酷的东西，学到了很多东西，我通过犯错误学到了一切，在学习中，我仍然做了我的问题。我把我的小米红米 Note 3 毁了，呃，bootloader 刚毁了。所以我不得不把它和我放在后面的 Windows 电脑重新连接，重新刷新所有东西，它已经放在这里三个月了。我受到每个人的各种各样的讨厌，因为我没有注意那个设备，所以我想我仍然会犯[错误]，所以即使这么多年过去了，仍然有东西要学，我非常幸运地经历了这个旅程，这太棒了。

好吧，我想既然你开始了...LG P500 是吗？

是啊是啊。

那是多少年前的事了？因为那一定是围绕着 Android 的最初版本，对吗？在弗罗约还是什么地方？

是啊，那是和 Froyo 一起发货的，几个月后升级成了姜饼。那个设备我想是 2010 年，2011 年初，可能更早。我知道我的 XDA 账户是在 2010 年 12 月创建的，但我事先就有这个设备。所以我想大概在那个时候，是的。

***从那以后 Android 是如何进化出性能智慧的？比如说你当时写内核和现在写内核有什么变化？我想你对这些变化有什么看法。***

就内核而言，我认为我们已经随着实际的 Linux 内核和 Android 团队实际上想要为某个 Android 版本实现的所有变化而发展，所以他们根据他们想要发布的内容规定了内核将具有的大多数特殊功能。但我猜实际性能，更多的内核实际上有很大帮助，因为那时你没有任何真正的方法来移动这个线程(原文如此)，或想象通过后台线程的网络请求，或至少实际的实时线程。我认为这是这些年来最大的变化，有更多的方法来分散你的工作，而不是因为每个人都试图抓住那一点点 CPU 份额而让 Android 变慢。最重要的是，我认为 Linux 支持多核和真正的多线程。我认为这是最大的变化。

好的，那么你对 HMP vs EAS 有什么看法？因为显然 EAS 只是新的，只在少数设备中使用——就像你使用谷歌 Pixel 一样，对吗？

是的，目前我使用的是 Galaxy S8，但我也有一个像素。我不太了解这两者的细节，它们只是多集群设备应该如何根据特定时间设备上发生的事情进行操作的不同实现。以两种不同的功耗运行两个不同的集群，这是相当困难的。你必须满足上下移动任务的期望，这涉及到一个延迟，HMP 是第一个真正为 ARM 实现真正的多集群架构的公司，因为如果我没记错的话，在 HMP 投入实际使用之前，三星有一个初始的实现，你要么使用前四个内核，比如低功耗内核，要么使用四个高性能内核，但它们从不同时运行。但后来有了 HMP，内核可以随时使用，任务可以从一个集群转移到另一个集群，反之亦然，但调度器没有那么多信息来显示给管理器，以实际决定在特定时间使用哪种频率，所以你必须处理，比如，试图了解在[大约] 20 秒内发生了什么，然后根据那里发生的事情，决定要做什么。EAS，它更多的是了解未来将会发生什么，并根据每个内核的功率输出实时做出决定，然后是一堆计算和后台复杂的事情

***像能量模型之类的都要背出来。***

是的，我想是的，这很复杂，我不知道所有的细节，我看过一堆文件，但这很复杂，不仅仅是打开开关就可以使用。我经常被问到这个问题，你能在 XYZ 的电话上实现 EAS 吗？我的回答总是*“这不是转动一个旋钮，不是这样的，它需要整个谷歌团队和来自 Linaro 的家伙来实现，你必须四处移动东西，做东西，测试东西，这只是太多的工作，有点盲目”*和…是的。很难。

所以你必须确切地知道你在做什么，这不是一个人的工作？

是的，你必须知道你在做什么，任何人都可以选择补丁并合并它们，但实际测试并确保它正常工作，你需要一个合适的机器来检测每个组件的功耗，内核上有一堆表格，你可以在其中写入每个内核的功耗，基于此，代码将决定做什么。挺复杂的。我不认为这是解决所有问题的确切方法，但这绝对是我们目前最好的方法。

***所以你把它看成是一种进步？***

是啊，当然，千里之外。这是 HMP 或任何其他架构的明显进步，因为如果你能理解未来会发生什么，你就能对任何请求或设备上发生的任何事情做出更快的反应，这就是谷歌 Pixel 如此快速和流畅的原因，因为一切几乎都是实时发生的。上下移动频率是达到预期性能的最简单方法。

我想，如果 EAS 的未来会有更多的采用，你认为这对你自己的内核开发会有什么影响？你会继续使用 HMP 还是已经发布的能源模型？例如，在 OnePlus 3 上，[ROM 开发者]正在为 EAS 重新使用谷歌 Pixel 的能源模型。你能想象自己做这样的事情吗？

我可能不会这样做，如果设备一开始就没有 EAS，那么我可能不会以任何方式或形式实现它，因为正如我所说，这是一个相当漫长的过程，在 XDA 没有人比所有这些工程师更清楚，所以我想我们只是想扮演上帝的角色。

在谈到 Android 和内核的未来时，你对最近发布的 Android Oreo 有什么看法？你认为这些变化是好的吗？你看过任何新的内核提交吗？

Nexus 6P 和 Nexus 5X 在内核方面没有太多变化，只是在一些地方做了一些小改动。在 Google Pixel 上，他们正在迭代 EAS 实现，他们花了一些时间来改进活页夹部分，因为现在活页夹和 Project Treble 一起，就像拆分不同的包，所以他们必须通过 50 或 100 个不同的补丁来改进活页夹，并将其分成不同的进程。除此之外，这只是一个大发布的正常工作。当有一个新的平台发布时，你通常不会对内核做太多的改动，因为改动内核实际上需要大量的 QA，如果你有时改变一个东西，你会听到它会影响另一个子系统中的东西。这就是他们通常所做的，这就是为什么你没有在平台升级之间进行内核版本升级。只是工作量很大。通常不值得，但是的，它主要是绑定的东西，一点点的调度程序，和通常的安全修复。我把它们都看了一遍，但没有什么真正引起我的注意。我的注意力只集中在活页夹上。

啊好吧，所以只是标准的东西。

是的，它们很复杂，不要问我细节！

这是一个完全不同的话题，你对 F2FS 对抗 ext4 有什么看法？因为你会看到很多人会说 F2FS 是不稳定的，并且会引起问题， **我只是想知道你对此有什么看法。**

我也不知道细节，因为文件系统很硬，到处都有很多活动部件。我将引用一位谷歌工程师的话，他说根据他们的测试，F2FS 的执行速度并不比 ext4 快，最重要的是，当他们测试 Google Pixel 的东西时，F2FS 不支持…我认为这是文件块加密，而 ext4 for 支持它。所以仅此一项就意味着-放弃吧。你必须考虑两件事，ext4 已经和来自不同公司的许多非常聪明的工程师一起工作了 20 年，他们知道他们在做什么。如果我没记错的话，F2FS 是三星实现的。这是一个相当新的文件系统，所以像这样复杂的东西需要时间来改进和迭代，正如你从刚刚在 iOS 上发布的苹果文件系统中看到的那样，他们将在 Mac OS 上做同样的事情。事情需要时间，你需要一个庞大的团队来正确地做这些事情。我非常支持“如果它在工作，就不要碰它”以及我们现在拥有的东西——它正在工作，我不认为它会给你带来任何性能问题，所以我看不出有什么理由去搞乱它。

***啊好吧，够公平了！[sd 卡 FS](https://www.xda-developers.com/diving-into-sdcardfs-how-googles-fuse-replacement-will-reduce-io-overhead/) 从熔丝切换到怎么办？你对此有什么看法？***

这是因为旧的 FUSE 文件系统是 Android 上发生的最糟糕的事情之一。性能很糟糕，在内核和用户空间之间有很多系统调用，现在有了 SDCardFS，它就可以正常工作了。这是一个正常的文件系统来处理这个问题，我也不知道细节，因为这是一个非常复杂的事情，但我从 Android 团队的不同播客中读到、看到和听到的是，它基本上修复了旧系统的所有问题。太可怕了，表演太可怕了。

* * *

[**点击此按钮查看第 2 部分！**](www.xda-developers.com/interview-francisco-franco-kernel-2)