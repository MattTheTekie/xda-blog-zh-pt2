<html>
<head>
<title>How to add Left/Right Cursors to the Nav Bar during Text Input on Android O</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Android O上输入文本时在导航条上添加左/右光标</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/how-to-add-leftright-cursors-to-the-nav-bar-during-text-input-on-android-o/#0001-01-01">https://www.xda-developers.com/how-to-add-leftright-cursors-to-the-nav-bar-during-text-input-on-android-o/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>自定义rom中最古老的功能之一是手动移动文本输入光标的能力，这一功能尚未进入Android的正式版本。根据您的ROM，您可以使用音量按钮或按导航条上的虚拟按钮来移动文本输入光标。如果你在打字时经常回去修改，这个功能是必不可少的，但是如果没有定制的ROM，你将无法享受它。</p>

  
<p>然而，如果你运行的是Android O开发者预览版，它在SystemUI Tuner下隐藏了一个新的<a href="https://www.xda-developers.com/android-o-preview-brings-nav-bar-customization-under-system-ui-tuner/">导航条定制器</a>，那么你可以在导航条上添加左/右键盘光标。你所需要做的就是将左边的导航条键设置为<a href="https://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_DPAD_LEFT">键码_ DPAD _左</a> (#21)，将右边的导航条键设置为<a href="https://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_DPAD_RIGHT">键码_ DPAD _右</a> (#22)。至于图标，使用默认的左/右箭头图标最有意义。正如<em> Android Police </em> ，<strong>指出的那样，<a href="http://www.androidpolice.com/2017/03/22/add-permanent-leftright-cursor-buttons-nav-bar-android-o/">这种方法肯定是有效的，但它有缺陷，因为它要求这些键被永久地<em>放置在</em>导航条上。</a></strong></p>





<p>如果<a href="https://www.xda-developers.com/how-to-display-a-picture-in-picture-mode-toggle-while-using-youtube-on-android-o/">你已经</a><a href="https://www.xda-developers.com/how-to-enable-media-playback-nav-bar-controls-in-android-o-when-playing-music/"/><a href="https://www.xda-developers.com/add-forward-backward-keys-to-android-o-nav-bar-quickly-read-emails/">跟随</a>我的<a href="https://www.xda-developers.com/how-to-add-page-scroll-keys-to-the-navigation-bar-while-using-chrome-in-android-o/">之前的</a> <a href="https://www.xda-developers.com/how-to-add-custom-icons-to-the-navigation-bar-in-android-o/">教程</a>上了Android O导航条定制器，那么你就会知道，可以根据我们想要的任何标准来改变两个导航条键。因此，为了使我们的新文本输入/键盘光标更具上下文意识，我们可以使用Tasker<strong>仅在Android O上显示文本输入时显示键盘光标按钮。</strong>我们将在本教程中提供逐步说明，但您也可以跳到底部下载配置文件以导入它。</p>

 
<p class="w-rich w-youtube" id="lrsNBid97P0">  </p>


<p><em>感谢Eli Irvin测试我的Tasker个人资料并捕获此屏幕记录！</em></p>

<hr/>


<h2 id="show-left-right-cursors-in-the-nav-bar-during-text-input">文本输入过程中在导航条中显示左/右光标</h2>

<p>Tasker是必要的，因为它是我们正在使用的自动化应用程序，当AutoInput检测到文本字段时，将通过SecureTask插件发送命令来更改我们的导航栏。安装完这些应用程序后，我们需要对它们进行设置。</p>

<p>虽然没有任何直接的方法来检测键盘何时显示，但我们可以监视的一件事是文本字段何时成为焦点。通过观察文本框中闪烁的光标，您将知道文本输入字段何时处于焦点上。我们可以通过使用刚刚发布的AutoInput的最新测试版来监控这些，这使我们能够实现这一点。为了让AutoInput监视文本字段，我们需要启用它的可访问性服务。</p>

<p>这样做非常快，只需进入设置-&gt;辅助功能，并在服务列表中寻找“自动输入”。启用辅助功能服务。</p>





<p>接下来，我们需要授予SecureTask修改设备上的系统设置的能力。为此，我们必须授予SecureTask一个称为WRITE_SECURE_SETTINGS的特殊权限，通常常规应用程序无法访问该权限，但用户可以通过ADB手动授予该权限。因此，您需要在您的机器上安装并运行ADB来使其工作。幸运的是，授予这种许可只是一次性的事情，所以如果你打算遵循我们的其他Android O相关指南，你最终将需要这样做。</p>

<h3 id="setting-up-adb">建立亚洲开发银行</h3>
<p>你需要做的第一件事是为你的操作系统下载ADB二进制文件。你可以在这里这样做。一旦你下载了它们，如果你用的是Windows，你需要确保你有合适的<a href="https://developer.android.com/studio/run/win-usb.html">驱动程序</a>。</p>

<p>一旦你将二进制文件解压到一个单独的文件夹并安装了驱动程序，我们接下来需要在智能手机上启用USB调试。为此，请打开“设置”,然后进入“关于手机”。点击7次Build Number直到你得到一个对话框告诉你你已经解锁了开发者选项。您现在可以在“设置”中访问开发人员选项。显然在Android O中，你必须输入你的pin/密码才能打开开发者选项。这样做，并寻找USB调试，然后启用它。</p>

<p>现在插上你的手机，在你解压ADB二进制文件的同一个目录下打开一个命令提示符。(Windows用户，按住shift键并右键单击该文件夹，然后选择“在此打开命令提示符”)在命令提示符下键入<code>adb devices</code>。你会看到一条消息，说亚行服务器正在启动，然后在你的手机上，你会看到一个提示，要求你授予你的计算机亚行访问。接受吧。现在，当您在命令提示符下输入<code>adb devices</code>时，您应该会看到您的设备的序列号，如果是这样，那么您就成功了。</p>

<h3 id="granting-write-secure-settings-to-securetask">向SecureTask授予WRITE_SECURE_SETTINGS</h3>
<p>打开ADB命令提示符后，输入以下命令授予SecureTask必需的权限。</p>

<pre> <code class="hljs css"><span class="hljs-selector-tag">adb</span> <span class="hljs-selector-tag">shell</span> <span class="hljs-selector-tag">pm</span> <span class="hljs-selector-tag">grant</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.balda</span><span class="hljs-selector-class">.securetask</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.permission</span><span class="hljs-selector-class">.WRITE_SECURE_SETTINGS</span></code> </pre>
<p>SecureTask现在将能够在没有root访问权限的情况下修改系统设置！现在我们准备向Tasker前进。</p>

<h3 id="setting-up-the-tasker-profile">设置任务者配置文件</h3>


<p>打开Tasker，按+按钮创建一个新的配置文件。将其命名为<strong>键盘光标</strong>并选择<strong>事件</strong>上下文。转到<strong>插件- &gt;自动输入- &gt; UI动作</strong>。对于动作类型，选择<strong>输入元素聚焦</strong>和<strong>输入元素聚焦丢失</strong>。将元素文本留空。添加这个AutoInput上下文将启动AutoInput的monitor服务，以检测文本输入字段何时获得或失去焦点，并将其作为我们可以读取的布尔值(真/假)存储在一个变量中。</p>





<p>一旦你完成了个人资料，Tasker会要求你添加一个任务。选择创建一个新的任务，但是不要麻烦给它一个名字。进入任务编辑屏幕后，添加以下操作:</p>



<ol> <li><strong> A1 </strong> : <em>任务- &gt; If </em>。将其设置为if %aifocus ~ true。这将是AutoInput检测到文本输入字段处于焦点时的条件。接下来的两个动作会将导航条键设置为DPAD左和DPAD右。</li> <li><strong> A2 </strong> : <em>插件- &gt;安全任务- &gt;安全设置</em>。动作:<strong>写</strong>。设置:<code>secure sysui_nav_bar_left</code>。值:<code>key(21:com.android/systemui/2131230907)</code>。</li> <li><strong> A3 </strong> : <em>插件- &gt;安全任务- &gt;安全设置</em>。动作:<strong>写</strong>。设置:<code>secure sysui_nav_bar_right</code>。值:<code>key(22:com.android/systemui/2131231004)</code>。</li> <li><strong> A4 </strong> : <em>任务- &gt;其他</em>。当%aifocus设置为false时，文本输入字段将失去焦点。然后我们将清除导航条键。</li> <li><strong> A5 </strong> : <em>插件- &gt;安全任务- &gt;安全设置</em>。动作:<strong>写</strong>。设置:<code>secure sysui_nav_bar_left</code>。值:<code>null</code>。</li> <li><strong> A6 </strong> : <em>插件- &gt;安全任务- &gt;安全设置</em>。动作:<strong>写</strong>。设置:<code>secure sysui_nav_bar_right</code>。值:<code>null</code>。</li> <li><strong> A7 </strong> : <em>任务- &gt;结束如果</em>。</li> </ol>





<p>您已经完成了这个Tasker脚本。现在，每当AutoInput检测到文本输入字段处于焦点时(这与您的键盘何时显示相关)，您将会看到两个新的导航条光标键，当文本输入字段不再处于焦点时，它们将会消失。</p>

<hr/>
<p class="ad-odd"> </p>


<h2 id="download-and-import">下载并导入</h2>
<p>与所有Tasker相关教程一样，我们将提供XML文件供您下载和导入。从下面的AndroidFileHost下载. prf.xml文件，并将其保存到您的内部存储。打开Tasker，长按顶部的Profiles标签，直到你看到一个导入按钮。点击它，找到您刚刚保存的XML文件，然后选择它来导入它。请确保您已经启用了AutoInput的辅助功能服务，并且已经将WRITE_SECURE_SETTINGS授予了我的文章中提到的SecureTask，否则此配置文件将不会在您的手机上执行任何操作！</p>

<p><a href="https://www.androidfilehost.com/?fid=817550096634758746"> <strong>从AndroidFileHost </strong>下载“键盘光标”配置文件</a></p>

<p>如果你想知道我们还可以在导航栏中添加哪些有用的按键，让Android O成为更愉快的体验，我们将在未来的教程中向你展示另一种设置。</p>

 </div>


</div>    
</body>
</html>