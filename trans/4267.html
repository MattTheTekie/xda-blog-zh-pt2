<html>
<head>
<title>Reverse Engineering Xiaomi OTA Updates to Find Unreleased Updates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>逆向工程小米OTA更新寻找未发布的更新</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/reverse-engineering-xiaomi-ota-updates/#0001-01-01">https://www.xda-developers.com/reverse-engineering-xiaomi-ota-updates/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>为了进入<a href="https://www.xda-developers.com/xiaomi">小米</a>的夜生活——小米MIUI操作系统未发布的内部版本——XDA资深成员<a href="https://forum.xda-developers.com/member.php?u=4572798"> duraaraa </a>对这家中国公司的空中下载(OTA)更新框架进行了逆向工程。这两个正在进行的漏洞迫使小米设备推出夜间版本，而不是最新的商业固件，理论上可以安装在现成的设备上，前提是(1) MIUI的OTA应用程序被反向工程，以及(2)测试版本与正式版本使用相同的密钥签名。</p>

 
<h2 id="method-1-crafting-a-xiaomi-ota-update-url">方法一:精心制作小米OTA更新网址</h2>
<p>两种方法中较简单的一种涉及访问OTA更新URL，它向客户端设备发送如何下载所述更新的指令。<a href="http://update.miui.com/updates/mi-updateV6.php?v=MIUI-7.9.21&amp;c=7.1&amp;d=chiron_global&amp;b=X">这个URL，例如</a>，包含告诉小米的OTA更新应用在哪里可以找到MIUI 9的7.9.21版本，这是一个内部测试版本。</p>

<pre> <code class="hljs javascript">{<span class="hljs-string">"UserLevel"</span>:<span class="hljs-number">9</span>,<span class="hljs-string">"LatestVersion"</span>:{<span class="hljs-string">"type"</span>:<span class="hljs-string">"rom"</span>,<span class="hljs-string">"device"</span>:<span class="hljs-string">"chiron_global"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"XM-MIMIX2-GLOBAL 7.9.21"</span>,<span class="hljs-string">"description"</span>:<span class="hljs-string">"MIUI\u5347\u7ea7"</span>,<span class="hljs-string">"descriptionUrl"</span>:<span class="hljs-string">"http:\/\/update.miui.com\/updates\/updateinfo\/7.9.21\/chiron_global_0_7.9.21_4494ccfcc506caca9904efb74b489e0a.html"</span>,<span class="hljs-string">"md5"</span>:<span class="hljs-string">"7f94ca393fae77c6171e6c7a551bea2e"</span>,<span class="hljs-string">"filename"</span>:<span class="hljs-string">"miui_MIMIX2Global_7.9.21_7f94ca393f_7.1.zip"</span>,<span class="hljs-string">"filesize"</span>:<span class="hljs-string">"1.6G"</span>,<span class="hljs-string">"codebase"</span>:<span class="hljs-string">"7.1"</span>,<span class="hljs-string">"version"</span>:<span class="hljs-string">"7.9.21"</span>,<span class="hljs-string">"branch"</span>:<span class="hljs-string">"X"</span>},<span class="hljs-string">"UpdateList"</span>:[{<span class="hljs-string">"type"</span>:<span class="hljs-string">"rom"</span>,<span class="hljs-string">"device"</span>:<span class="hljs-string">"chiron_global"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"XM-MIMIX2-GLOBAL 7.9.21"</span>,<span class="hljs-string">"description"</span>:<span class="hljs-string">""</span>,<span class="hljs-string">"descriptionUrl"</span>:<span class="hljs-string">"http:\/\/update.miui.com\/updates\/updateinfo\/7.9.21\/chiron_global_0_7.9.21_4494ccfcc506caca9904efb74b489e0a.html"</span>,<span class="hljs-string">"md5"</span>:<span class="hljs-string">"7f94ca393fae77c6171e6c7a551bea2e"</span>,<span class="hljs-string">"filename"</span>:<span class="hljs-string">"miui_MIMIX2Global_7.9.21_7f94ca393f_7.1.zip"</span>,<span class="hljs-string">"filesize"</span>:<span class="hljs-string">"1.6G"</span>,<span class="hljs-string">"codebase"</span>:<span class="hljs-string">"7.1"</span>,<span class="hljs-string">"version"</span>:<span class="hljs-string">"7.9.21"</span>,<span class="hljs-string">"branch"</span>:<span class="hljs-string">"X"</span>}],<span class="hljs-string">"IncrementalUpdateList"</span>:[],<span class="hljs-string">"MirrorList"</span>:[<span class="hljs-string">"http:\/\/bigota.d.miui.com"</span>],<span class="hljs-string">"Signup"</span>:{<span class="hljs-string">"version"</span>:<span class="hljs-string">""</span>,<span class="hljs-string">"total"</span>:<span class="hljs-string">""</span>,<span class="hljs-string">"rank"</span>:<span class="hljs-string">""</span>},<span class="hljs-string">"AuthResult"</span>:<span class="hljs-number">0</span>,<span class="hljs-string">"ForceUpdate"</span>:<span class="hljs-number">0</span></code> </pre>
<p>当一个稳定的版本最近开始在中国推出时-8 . 5 . 7 . 0 . ndecnef-<a href="https://forum.xda-developers.com/member.php?u=4572798">dura ara</a>利用这个漏洞找到了固件的升级URL。</p>
<p class="ad-odd"> </p>


<h2 id="method-2-crafting-a-xiaomi-ota-update-request">方法2:制作小米OTA更新请求</h2>
<p>第二种方法稍微复杂一点，包括获取小米更新服务器的解密密钥。这需要反编译更新应用程序，并使用Xposed来捕获和分析网络流量。</p>

<p>当解密密钥(例如“miuiotavalided11”)存在时，理论上，任何用户都可以生成一个伪造的升级请求。</p>
<p class="ad-even"> </p>


<h2 id="forcing-xiaomi-ota-upgrades">迫使小米OTA升级</h2>
<p>duraaraa使用这两种方法在小米的服务器上找到了未发布的MIUI版本，但还没有成功下载并在小米设备上安装。他要求开发社区的成员参与到这项工作中来。</p>

<p>要跟踪新的发展和/或自愿提供您的专业知识，请查看XDA论坛的帖子。</p>

<hr/>

<p><a href="https://forum.xda-developers.com/mi-mix-2/how-to/guide-reverse-engineering-xiaomi-ota-t3691612"> <strong>小米OTAs </strong> </a>逆向工程探讨</p>

 </div>


</div>    
</body>
</html>