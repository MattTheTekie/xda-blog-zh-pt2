<html>
<head>
<title>Android 11 will introduce an "App Compatibility" Developer Option to help test platform changes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Android 11将引入“应用兼容性”开发者选项，以帮助测试平台变化</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/android-11-new-app-compatibility-developer-option-dev-test-new-platform-changes/#0001-01-01">https://www.xda-developers.com/android-11-new-app-compatibility-developer-option-dev-test-new-platform-changes/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>每年在谷歌I/O大会上，谷歌都会强调下一版本Android的一些最激动人心的变化。虽然大多数用户通过影响他们体验的视觉变化来判断Android版本，但每个Android更新也带来了大量API和<a href="https://www.xda-developers.com/android-q-storage-access-framework-scoped-storage/">平台行为</a>的<a href="https://www.xda-developers.com/android-q-record-audio-monitor-device-temperature/">变化。这些变化对于应用程序开发人员来说非常重要，他们需要注意并准备好应用程序，因为它们可以从根本上改变最终用户使用应用程序的方式。随着下一个版本的Android，Android 11，谷歌将通过开发者选项中新的“应用兼容性”设置，让开发者更容易测试和准备他们的应用程序，以适应即将到来的变化。</a></p>

  
<p>每当谷歌发布一个新的Android版本时，那些有兴趣积极维护他们的应用程序的应用程序开发人员需要仔细阅读新的变化以及伴随这些变化而来的文档。然后，他们可以决定更新他们的应用程序，以添加这些新的API功能，如果他们想要或将现有API的使用迁移到新的API，这是一个可选或不可选的途径。应用程序开发人员不必立即更新他们应用程序的目标API，但他们最终必须这样做，以满足谷歌Play商店的<a href="https://www.xda-developers.com/all-apps-require-target-android-pie-play-store/">移动目标API要求。在此之后，开发人员还需要在新的Android版本上实际测试他们的应用程序，这可以在模拟设备、云托管设备或本地设备上完成。测试是开发例程的一部分，但是当涉及到重大变更时，测试变得更加重要。</a></p>

<p>此外，当谷歌想要引入重大的平台行为变化时，他们不会立即在新的Android版本发布中实现这一变化。这是为了保护用户避免他们的应用程序崩溃和失去功能，同时也给了开发者更多的时间来更新他们的应用程序。比如在Android 7牛轧糖中，谷歌为了节省电池寿命，决定<a href="https://www.xda-developers.com/how-android-n-will-improve-battery-and-memory-management/">限制一些隐式广播</a>。有了Android 8 Oreo，谷歌<a href="https://developer.android.com/guide/components/broadcast-exceptions">完全限制应用程序注册隐式广播接收器</a>。但在Android 8 Oreo发布之前，谷歌希望开发者为他们的应用程序不再能够注册隐式广播接收器的情况做好准备。为此，开发者可以<a href="https://developer.android.com/topic/performance/background-optimization#further-optimization">在Android 7 Nougat中使用ADB命令来模拟隐式广播不可用的情况</a>:</p>

<pre> <code class="hljs sql">adb shell cmd appops <span class="hljs-keyword">set</span> RUN_IN_BACKGROUND <span class="hljs-keyword">ignore</span></code> </pre>
<p>像上面这样的ADB命令是一个例子，说明了Google如何允许应用程序开发人员测试他们的应用程序在Android平台行为变化下的行为。</p>

<p>另一个最近的例子是，在Android Q Beta 2中，<a href="https://android-developers.googleblog.com/2019/04/android-q-beta-2-update.html"> Google要求开发人员通过运行ADB命令在他们的应用程序上测试作用域存储</a>:</p>

<pre> <code class="hljs sql">adb shell cmd appops <span class="hljs-keyword">set</span> your-<span class="hljs-keyword">package</span>-<span class="hljs-keyword">name</span> android:legacy_storage <span class="hljs-keyword">default</span> &amp;&amp; \</code> </pre>
<p>作为一名应用程序开发人员，可以假定您熟悉ADB命令，并且不反对使用它们来测试这些平台变化。但总有改进的空间，谷歌通过引入一个简单的用户界面来控制这些变化，使这个测试过程变得更容易。</p>

<p>有了新的<a href="https://android-review.googlesource.com/q/platformcompat"> PlatformCompat项目</a>，开发者不再需要为每个新的平台行为变化运行ADB命令。在Android 11中，Android将在开发者选项中有一个新的子菜单，可以在每个应用程序的基础上快速切换新的平台行为变化，而无需发送任何ADB shell命令。每个目标API级别将有不同的部分，例如，API级别&gt; 29将有其自己的一组可以切换的行为改变，而API级别&gt; 30将有其自己的一组改变。</p>



<p>在上面展示应用程序兼容性部分的截图中(来自运行在仿真器上的源代码构建的AOSP)，“默认启用的更改”部分包括Android 11 API更改，这些更改将默认在所有应用程序上启用，而不管其目标SDK。“针对targetSDKversion &gt; 29启用”部分是Android 11 API更改，仅针对针对Android 11/API级别30的应用启用。</p>

<p>虽然这种特殊的变化不会直接让最终用户兴奋，但它确实让应用程序开发人员的工作变得更容易，这总是一件好事。</p>

<hr/>

<p><em>感谢XDA知名开发商<a href="https://forum.xda-developers.com/member.php?u=5778309"> luca020400 </a>提供的提示和随附的截图。</em></p>

<p>关于Android 11的更多报道:</p>


</div>


</div>    
</body>
</html>