# 如何在播放音乐时启用 Android O 中的媒体播放导航条控件

> 原文：<https://www.xda-developers.com/how-to-enable-media-playback-nav-bar-controls-in-android-o-when-playing-music/>

Android O 开发者预览版才发布了一周，但我们很快发现了所有新功能越来越多的潜在用途。我们最感兴趣的特性之一是系统 UI 调谐器中新的[导航栏定制器](https://www.xda-developers.com/android-o-preview-brings-nav-bar-customization-under-system-ui-tuner/)。

初步看来，谷歌的实现似乎相当简单。虽然您可以在现有键的左侧和右侧添加新的导航键，但是您添加的任何键都将永久位于您的导航栏上。不幸的是，这使得这个功能对许多人来说毫无用处，因为你想在导航条上使用的许多键只在特定的情况下才起作用。但是正如我们之前向你展示过的，事实上在你自己定制的条件下启用特定的导航条键是可能的。在本教程中，我们将向您展示当 Google Play Music 或任何其他音乐应用程序播放音乐时，如何**启用导航栏中的媒体播放控制按钮**。

*感谢 Eli Irvin 为我测试，并捕捉到这个屏幕记录！*

* * *

Tasker 是必要的，因为它是我们用来检测我们在什么应用程序中的自动化应用程序，并通过 SecureTask 插件发送命令，这将处理我们的导航栏的更改。安装完这些应用程序后，我们需要对它们进行设置。

为了检测音乐何时播放，我们需要为通知监听器插件启用通知访问。这样做是非常快速的，只需进入设置，并在搜索栏中搜索“通知访问”。打开设置页面，查找通知监听器，并授予它读取通知的权限。

接下来，我们需要授予 SecureTask 修改设备上的系统设置的能力。为此，我们必须授予 SecureTask 一个称为 WRITE_SECURE_SETTINGS 的特殊权限，通常常规应用程序无法访问该权限，但用户可以通过 ADB 手动授予该权限。因此，您需要在您的机器上安装并运行 ADB 来使其工作。幸运的是，授予这个权限是一次性的事情，我们将在未来的 Android O 相关教程中使用 SecureTask，所以我绝对建议你现在就这么做。如果你已经遵循了我之前的教程，在那里我告诉你安装自动工具，SecureTask 的功能不太丰富，但它已经足够满足我们的需要了。

### 建立亚洲开发银行

你需要做的第一件事是为你的操作系统下载 ADB 二进制文件。你可以在这里这样做。一旦你下载了它们，如果你用的是 Windows，你需要确保你有合适的[驱动程序](https://developer.android.com/studio/run/win-usb.html)。

一旦你将二进制文件解压到一个单独的文件夹并安装了驱动程序，我们接下来需要在智能手机上启用 USB 调试。为此，请打开“设置”,然后进入“关于手机”。点击 7 次 Build Number 直到你得到一个对话框告诉你你已经解锁了开发者选项。您现在可以在“设置”中访问开发人员选项。显然在 Android O 中，你必须输入你的 pin/密码才能打开开发者选项。这样做，并寻找 USB 调试，然后启用它。

现在插上你的手机，在你解压 ADB 二进制文件的同一个目录下打开一个命令提示符。(Windows 用户，按住 shift 键并右键单击该文件夹，然后选择“在此打开命令提示符”)在命令提示符下键入`adb devices`。你会看到一条消息，说亚行服务器正在启动，然后在你的手机上，你会看到一个提示，要求你授予你的计算机亚行访问。接受吧。现在，当您在命令提示符下输入`adb devices`时，您应该会看到您的设备的序列号，如果是这样，那么您就成功了。

### 向 SecureTask 授予 WRITE_SECURE_SETTINGS

打开 ADB 命令提示符后，输入以下命令授予 SecureTask 必需的权限。

```
 adb shell pm grant com.balda.securetask android.permission.WRITE_SECURE_SETTINGS 
```

SecureTask 现在将能够在没有 root 访问权限的情况下修改系统设置！现在我们准备向 Tasker 前进。

### 设置任务者配置文件

我们将在这里创建两个单独的 Tasker 配置文件。一个是当我们选择的音乐播放器(在我的例子中是 Google Play Music)开始播放音乐时做出反应(它的通知已经发布)，另一个是当同一个音乐播放器的通知被取消时做出反应。

打开 Tasker，点击右下角的+图标创建一个新的配置文件。我们将从创建一个当音乐播放器的通知发布时触发的配置文件开始。将配置文件命名为“启用媒体导航键”，并选择一个事件上下文。转到插件->通知监听器->通知监听器。对于通知事件，选择**发布的**，并在应用程序下选择您想要监控的应用程序(如 Google Play Music)。

完成后，退出，Tasker 会要求您将任务附加到此配置文件。可以给任务命名，但没必要。只需点击复选标记即可进入任务编辑屏幕。进入后，我们将向该任务添加两个操作。

1.  A1:插件->安全任务->安全设置。动作:**写。**设置:`secure sysui_nav_bar_left`。值:`key(88:com.android.systemui/2131230907)`。这是 KEYCODE_MEDIA_PREVIOUS，将在导航栏中显示为左箭头。
2.  A2:插件->安全任务->安全设置。动作:**写。**设置:`secure sysui_nav_bar_right`。值:`key(87:com.android.systemui/2131231004)`。这是 KEYCODE_MEDIA_NEXT，将在导航栏中显示为右箭头。

接下来，我们将创建当音乐应用程序的通知被取消时触发的第二个配置文件。当通知被解除时，此配置文件将删除媒体控制键。创建一个新的配置文件，并将其命名为“禁用媒体导航键。”再次创建事件上下文并选择通知监听器插件。这一次，对于通知事件，选择**移除**，但再次选择您想要监控的同一个音乐应用。

再次添加一个任务(没有名称也可以)并创建以下两个操作:

1.  A1:插件->安全任务->安全设置。动作:**写。**设置:`secure sysui_nav_bar_left`。值:`null`。
2.  A2:插件->安全任务->安全设置。动作:**写。**设置:`secure sysui_nav_bar_right`。值:`null`。

这两个操作将清除您的导航栏键，因此媒体播放控制键将不再存在。

就是这样！现在，当您开始播放音乐时，您会在导航栏上看到额外的按键来控制媒体，但当您关闭音乐播放器的通知时，这些按键将会消失。

* * *

## 下载并导入

与所有 Tasker 相关教程一样，我们将提供 XML 文件供您下载和导入。从下面的 AndroidFileHost 下载 prf.xml 文件，并将其保存到您的内部存储中。打开 Tasker，长按顶部的 Profiles 标签，直到你看到一个导入按钮。点击它，查找您刚刚保存的 XML 文件，然后选择它们以导入它们(您必须一个接一个地做这件事)。请确保您已经授予通知访问通知监听器启用，并已授予 WRITE_SECURE_SETTINGS 权限 SecureTask，如我的文章中所述，否则这些配置文件将不会在您的手机上做任何事情！

[**从 AndroidFileHost**](https://www.androidfilehost.com/?fid=673368273298943659) 下载“启用媒体导航键”配置文件

[**从 AndroidFileHost**](https://www.androidfilehost.com/?fid=529152257862715642) 下载“禁用媒体导航键”配置文件

如果你想知道我们还能通过 SecureTask 和 Android O 完成什么，请继续关注 XDA 门户网站，因为我们有更多内容可以分享。期待更多关于如何让 Android O 中的导航栏实现许多有用功能的教程！