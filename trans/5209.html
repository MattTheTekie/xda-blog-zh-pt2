<html>
<head>
<title>Taskbar 4.0 brings back freeform window support to Android Pie devices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>任务栏4.0为Android Pie设备带回了自由形式窗口支持</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/taskbar-freeform-window-android-pie/#0001-01-01">https://www.xda-developers.com/taskbar-freeform-window-android-pie/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>对Android多窗口的支持最初是由三星普及的，但该功能慢慢进入了Android。Android 6.0 Marshmallow引入了分屏多窗口支持，而Android 7.0 Nougat悄悄添加了自由形式窗口支持，尽管解锁自由形式窗口支持需要ADB命令或启用开发者选项。不幸的是，随着第一个Android P开发者预览版的发布，似乎自由形式窗口支持被移除了，因为用于支持它的传统方法不再有效。令人欣慰的是，现在有一个变通办法可以在<a href="https://www.xda-developers.com/android-pie-google-pixel-google-pixel-2/"> Android Pie设备</a>上恢复自由形式窗口支持，而且不需要root！</p>

  
<p>XDA资深会员<a href="https://forum.xda-developers.com/member.php?u=4289533">farmerbb</a>,<a href="https://forum.xda-developers.com/android/apps-games/app-taskbar-freeform-window-enabler-t3517608">任务栏</a>的开发者，在Android 9 Pie的<a href="https://www.xda-developers.com/android-pie-source-code-aosp/">源代码发布</a>后，发现了启动自由形式窗口的新方法。我在Twitter<a href="https://twitter.com/farmerbb1/status/1029153593264230400">上联系了这位开发者，听听他对Android Pie中应用窗口的改变的看法，以下是他的回答:</a></p>

<blockquote>
<p/><h4>Android Pie似乎已经抛弃了窗口“堆栈”的概念，取而代之的是一种叫做<a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/WindowConfiguration.java">窗口配置</a>的东西...每个应用程序窗口都可以分配一个特定的窗口模式。自由形式窗口只是列出的各种窗口模式中的一种。当开始一个活动时，你可以通过调用<a href="https://android.googlesource.com/platform/frameworks/base/+/android-9.0.0_r3/core/java/android/app/ActivityOptions.java#1199">这个方法</a>(使用反射)来设置它使用任何你想要的窗口模式。</h4>
 </blockquote>
<p>因此，为什么早期版本的任务栏不再能启动自由形式的窗口是因为Android改变了应用程序窗口模式的确定方式。有了现在可用的源代码，farmerbb就能够找出如何使用新方法启动自由形式的窗口。他解释道:</p>

<blockquote>
<p/><h4>您可以:</h4>
<ul> <li><h4>使用通过反射调用的setLaunchWindowingMode方法启动一个提供ActivityOptions包的活动(需要27或更早版本的targetSdk，否则您会遇到非Sdk接口限制<a href="https://www.xda-developers.com/google-undocumented-hidden-apis-android-p/">这里是</a>。</h4></li> <li><h4>或者，使用提供的- windowingMode参数通过adb运行am start-activity命令，例如:ADB shell am start-activity-windowing mode 5 com.farmerbb.taskbar/.MainActivity</h4></li> </ul>
 </blockquote>
<p>(如果你有兴趣了解Android 9 Pie之前自由形式窗口支持是如何工作的，可以看看<a href="https://www.xda-developers.com/android-nougats-freeform-window-mode-what-it-is-and-how-developers-can-utilize-it/"> farmerbb在XDA </a>上的精彩客座博文。)</p>

<p>farmerbb选择了第一种方式，因此，目前来看，该应用程序的targetSdkVersion是27，而不是28。一旦他被迫将targetSdkVersion提高到28，他将不得不使用我推荐的变通方法(如果到那时这仍然有效的话)。)不过，当我们到达那一点时，我们会过桥的。</p>

 
<h2 id="bring-back-freeform-windows-on-android-pie">在Android Pie上带回自由形式的窗口</h2>
<p>如果你对在Android 9 Pie设备上获得自由形式的窗口感兴趣，那么你所要做的就是从谷歌Play商店安装最新版本的任务栏应用程序。最新版本4.0已经推出。只需安装应用程序，并按照安装说明在应用程序中启用自由模式。如果你过去使用过这个应用程序来启动自由形式的窗口，你会注意到之前的实现和它现在在Android Pie中的工作方式有一个直接的区别。我会让法默伯解释:</p>

<blockquote>
<p/><h4>这一变化的副作用是，现在自由形式的窗口可以浮动在全屏窗口的顶部，而不是局限于自己的堆栈！很酷的改变，虽然你不能像PIP窗口一样把它们固定在窗口的顶层。</h4>
 </blockquote>
<p>顺便说一下，这看起来是这样的:</p>





<p>不要用这个来强迫YouTube进入伪PiP模式。它不起作用。你只需要<a href="https://www.xda-developers.com/youtube-picture-in-picture-rolling-out-us-non-red-premium-users/">等待YouTube PiP在你的地区推出</a>或者升级到<a href="https://www.xda-developers.com/revamped-youtube-music-soon-youtube-premium-later/"> YouTube Premium </a>。无论如何，如果你想将这个功能用于其他目的，这里有下载该应用程序的链接。</p>

 


</div>


</div>    
</body>
</html>