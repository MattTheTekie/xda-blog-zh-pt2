<html>
<head>
<title>Google's Incremental FS lets you play big games before fully downloading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>谷歌的增量FS让你在完全下载前玩大型游戏</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/google-incremental-file-system-android-big-games/#0001-01-01">https://www.xda-developers.com/google-incremental-file-system-android-big-games/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>根据市场研究公司<a href="https://newzoo.com/insights/articles/newzoo-adjusts-global-games-forecast-to-148-8-billion-slower-growth-in-console-spending-starts-sooner-than-expected/"> <em> Newzoo </em> </a>的数据，移动游戏是一个巨大的市场，其总收入占2019年全球游戏市场的近一半。Play Store每周都有大量新游戏可供尝试，如果您的游戏时间有限，这可能会很难跟上。谷歌正在为未来版本的Android开发新的文件系统，可能是2021年的<a href="https://www.xda-developers.com/android-12/"> Android 12 </a>，这将使尝试新游戏更加容易。该文件系统被称为增量文件系统，它被设计为允许在应用程序的二进制文件和资源文件仍在下载的同时执行应用程序。</p>

  
<p>2019年5月初，谷歌<a href="https://lwn.net/Articles/787606/">提交了补丁</a>，将对增量文件系统的支持合并到Linux内核中。<a href="https://lore.kernel.org/linux-fsdevel/20190502040331.81196-1-ezemtsov@google.com/T/#Z2e.:..:20190502040331.81196-2-ezemtsov::40google.com:0Documentation:filesystems:incrementalfs.rst">根据Google提交的文档</a>，Incremental FS是一个“特殊用途的Linux虚拟文件系统，它允许在程序的二进制文件和资源文件仍在通过网络、USB等被缓慢下载时执行程序。”这个特性的目的是“允许在二进制文件和资源完全下载到Android设备之前运行大型Android应用程序。”现在，如果你想玩一个5GB大小的Android游戏，你必须等到整个下载完成后才能启动游戏。谷歌表示，增量FS可以“无摩擦地等待(暂时)丢失的数据”，这意味着当它继续下载越来越多的完整游戏时，你可以启动游戏。在我们假设的5GB Android游戏中，假设游戏的intro大小为200MB，偏移量为1GB。使用增量文件系统，可以下载游戏的第一个MB的数据，当它被执行时，该过程可以调用1GB偏移量的第一个MB的数据来下载，从而允许开始介绍。然后，剩下的200MB介绍数据可以被下载，这将有望比介绍播放得更快，然后游戏的主菜单可以被加载。当需要加载下一组数据时，可能会有一个小的执行冻结。该菜单位于150MB的偏移量，但这将允许用户更快地进入游戏，而不是等待整个下载完成。</p>

<p>在向Linux内核提交补丁之后，Google与多个Linux内核维护者就FS的实现和目的进行了讨论。一些人批评Google创建了一个定制的内核文件系统，而不是扩展现有的FUSE，或者用户空间中的文件系统。谷歌称<a href="https://www.xda-developers.com/diving-into-sdcardfs-how-googles-fuse-replacement-will-reduce-io-overhead/">基于FUSE的文件系统为其目标场景增加了显著的性能开销</a>，增加了功耗，以至于手机消耗能量的速度超过了通过电线充电的速度。这是有问题的，因为一个谷歌人说“项目的目标是允许从开发环境到Android(手机)的即时应用部署。”基于这个评论，我们认为Google只是打算用这个特性来帮助开发者测试他们手机游戏的增量版本。然而，在对最初的Linux内核补丁进行最后一次评论几个月后，情况可能仍然如此，谷歌<a href="https://android-review.googlesource.com/q/incremental">开始将与增量文件系统相关的</a>提交合并到安卓开源项目(AOSP)。这些提交给Android和Android的Linux内核的许多部分带来了巨大的变化，所以我们认为谷歌可能正计划使用增量文件系统来改善总体用户体验。也许谷歌想让用户开始玩大型安卓游戏，而不必完全下载——本质上是作为原生的<a href="https://www.xda-developers.com/tag/instant-apps/">即时应用</a>的替代品，不需要开发者做任何额外的工作，因为实现是在内核中。</p>

<p>目前，谷歌正在Pixel 4 XL  (coral)上测试该功能<a href="https://android-review.googlesource.com/c/platform/system/sepolicy/+/1234498">，他们还</a><a href="https://android-review.googlesource.com/c/kernel/common/+/1222873">构建了一个内核模块</a>，用于通用内核映像(GKI)。在一些评论中，谷歌解释说，具有这一功能的Android设备将有一个新的/data/incremental目录，其中包含设备上每个应用程序的子目录。子目录将包含apk、本地库和OBB文件。在这些子目录中，将挂载增量文件系统，并且每个子目录都将被绑定挂载到原始安装目录，即。/data/app/。谷歌Play商店<a href="https://android-review.googlesource.com/c/platform/system/sepolicy/+/1234499">将能够检查安装在增量FS上的应用程序的文件签名</a>，这将可能阻止具有与当前安装的应用程序不同的签名的增量应用程序的执行。</p>

<p>鉴于这项功能的工作仍在进行中，Android 11主要功能变化的内部截止日期可能很快就会到来，如果尚未过去，我们怀疑设备不会在2021年Android 12之前开始支持增量文件系统。我们将继续跟踪这项功能的发展，当然，如果我们对它的工作原理有了更多的了解，我们会及时更新。</p>

<hr/>

<p>感谢XDA知名开发商<a href="https://forum.xda-developers.com/member.php?u=1915408"> phhusson </a>和<a href="https://forum.xda-developers.com/member.php?u=5778309"> luca020400 </a>的投入！</p>

 </div>


</div>    
</body>
</html>