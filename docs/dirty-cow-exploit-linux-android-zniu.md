# 脏牛现在在安卓上被 ZNIU 虐

> 原文：<https://www.xda-developers.com/dirty-cow-exploit-linux-android-zniu/>

Dirty COW([Dirty Copy-On-Write)，或 CVE-2016-5195](https://www.xda-developers.com/9-year-old-linux-kernel-bug-dubbed-dirty-cow-can-root-every-version-of-android/) ，是一个 9 岁的 Linux bug，于去年 10 月被发现。这是在 Linux 内核中发现的最严重的错误之一，现在被称为 ZNIU 的恶意软件已经在野外发现。该漏洞在 2016 年 12 月的安全更新中得到修补，但任何没有收到该漏洞的设备都容易受到攻击。有多少台设备？相当多。

正如你在上面看到的，实际上有相当数量的设备来自 Android 4.4 之前，当时谷歌开始制作安全补丁。更重要的是，任何 Android 6.0 或更低版本的设备实际上都将面临风险**，除非他们在 2016 年 12 月之前收到任何安全补丁，**，除非这些补丁正确地针对了漏洞**。**随着很多厂商对安全更新的疏忽，很难说大多数人真正得到了保护。由 *TrendLabs* 进行的一项分析揭示了许多关于 ZNIU 的信息。

## ZNIU -第一个在 Android 上使用 Dirty COW 的恶意软件

首先让我们弄清楚一件事，ZNIU 是**而不是**第一次记录脏牛在 Android 上的用法。事实上，我们论坛上的一个用户使用了 Dirty COW exploit (DirtySanta 基本上就是 Dirty COW) [解锁了 LG V20](https://www.xda-developers.com/dirtysanta-exploit-unlocks-the-bootloader-of-the-lg-v20-h990/) 的引导加载程序。ZNIU 只是该漏洞被用于恶意目的的第一次记录。这可能是因为应用程序非常复杂。在撰写本文时，它似乎活跃在 40 个国家，感染用户超过 5000 人。它伪装在色情和游戏应用程序中，存在于 1200 多个应用程序中。

## ZNIU 脏牛恶意软件是做什么的？

首先，ZNIU 的 Dirty COW 实现只在 ARM 和 X86 64 位架构上工作。这听起来不算太糟糕，因为大多数 64 位架构的旗舰通常至少会有 2016 年 12 月的安全补丁。然而，**任何 32 位设备** **也可能会受到**lovyroot 或 KingoRoot 的影响，这是六个 ZNIU rootkits 中的两个使用的。

但是 ZNIU 是做什么的呢？它大多以色情相关应用的形式出现，但也可以在游戏相关应用中找到。安装后，它会检查 ZNIU 有效负载的更新。然后，它将开始权限提升，获得根用户访问权限，绕过 SELinux 并在系统中安装后门，以备将来的远程攻击。

一旦应用程序初始化并安装了后门程序，它就开始将设备和运营商信息发送回位于 mainland China 的服务器。然后，它开始通过运营商的支付服务向一个账户转账，但前提是被感染的用户有一个中国手机号码。确认交易的消息随后被拦截和删除。中国以外的用户将被记录数据并安装一个后门，但不会从他们的账户中进行支付。拿走的钱少得可笑，以至于没有引起注意，相当于一个月 3 美元。ZNIU 为其 SMS 相关操作利用根访问，因为要与 SMS 进行交互，应用程序通常需要由用户授予访问权限。**它还能感染设备上安装的其他应用程序。**所有通信都经过加密，包括下载到设备上的 rootkit 有效载荷。

尽管进行了上述加密，但混淆过程非常糟糕，以至于 TrendLabs 能够确定用于恶意软件和服务器之间通信的网络服务器的详细信息，包括位置。

## ZNIU 脏牛恶意软件是如何工作的？

它的工作原理相当简单，从安全角度来看也很有趣。应用程序下载当前运行设备所需的有效载荷，并将其提取到一个文件中。该文件包含恶意软件运行所需的所有脚本或 ELF 文件。然后，它写入虚拟动态链接共享对象(vDSO ),这通常是一种在内核中为用户应用程序(即非根应用程序)提供工作空间的机制。这里没有 SELinux 限制，这才是脏牛的“魔力”真正发生的地方。它创建了一个“反向外壳”，简单地说，这意味着机器(在这种情况下，你的手机)正在执行命令给你的应用程序，而不是相反。这使得攻击者能够访问设备，ZNIU 通过修补 SELinux 和安装后门根外壳来实现这一点。

## 那么我能做什么呢？

真的，你能做的就是远离不在 Play Store 上的应用。谷歌已经向 TrendLabs 确认 **Google Play Protect 现在可以识别应用程序**。如果您的设备安装了 2016 年 12 月或更高版本的安全补丁，您也是完全安全的。

* * *

[**来源:TrendLabs**](http://blog.trendmicro.com/trendlabs-security-intelligence/zniu-first-android-malware-exploit-dirty-cow-vulnerability/)