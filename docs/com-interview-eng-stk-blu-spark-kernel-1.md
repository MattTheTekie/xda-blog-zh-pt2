# 采访开发者 eng.stk 第 1 部分:起源和内核开发

> 原文：<https://www.xda-developers.com/com-interview-eng-stk-blu-spark-kernel-1/>

# blu_spark 内核开发人员 eng.stk 访谈-第 1 部分:起源和内核开发

我们最近采访了 blu_spark 内核的开发者 eng.stk。在这一部分，我们询问他的起源和发展工作。

我最近有机会采访了 blu_spark 内核的开发者 XDA 资深会员 [eng.stk](https://forum.xda-developers.com/member.php?u=3873953) 。它可以在我们的论坛上的许多设备上使用，包括 Nexus 5、OnePlus 3/T 和 OnePlus 5T。在这一部分，我们向 eng.stk 询问他的开发起源，以及他是如何开发 blu_spark 内核的。

* * *

**首先，介绍一下你自己和你的内核。你的内核如何在竞争中脱颖而出？你对内核改变的设计理念是什么，你是如何着手的？**

> #### 我是 eng.stk，从 2010 年开始在 XDA 工作。你们大多数人都是从我的 code_blue 和 blu_spark 项目中认识我的:)
> 
> #### 我开始在 XDA 写一些脚本和杂项工具，框架黑客。我也做过很多主题化的工作...在我任职期间，我还直接参与了一些项目，比如 Purity ROM、Universal Kernel Manager、Kernel Adiutor 以及最近的 Magisk 和 [WireGuard](https://www.xda-developers.com/wireguard-vpn-project-support-android-roms/) 等等。我最近也在做一些 TWRP 的工作(特别是在一加的设备上)，Magisk 模块和其他工具/黑客，这些在我的内核项目的生命周期中是有用的(如果我没记错的话，有些东西是在 XDA 门户网站上)。blu_spark 内核开始变得不仅仅是一个内核，而是一个在内核、工具链、恢复、主题化、工具、脚本等之间的全方位体验。但是内核工作是我最喜欢的，也是我的动力。
> 
> #### 当我有机会的时候，我总是喜欢到处乱搞和构建一些代码/脚本(在我表弟的 Commodore 64 上拆卸电子玩具和基本编码很有趣)。对我来说，编码不是达到目的的一种手段，而只是一种工具，就像其他一些工具一样，是为了达到一个明确的目的。我大部分比较严肃的东西和工作的基础都是在我青春期/二十出头发现 Linux 的时候完成的。后来，在大学时代的某个时候，Android 对我来说是合乎逻辑的下一步:实际上是一个修补匠的梦想，在那里硬件或软件可以玩很多。
> 
> #### 形容 blu_spark 最好的词就是优化和稳定。使用它的人知道他们可以依赖它。我的内核版本有点“保守”,我倾向于不删除一些现成的东西，让所有东西都是可选的，以便人们可以选择。我不喜欢添加太多东西，我只是改变或添加我认为对每个领域最好的东西。CPU 频率驱动程序、IO 调度程序、网络协议、文件系统等，或者为一些给定的参数调整一些可调参数，或者上游的一些驱动程序，以获得可能的最佳结果。我还构建定制的工具链(来自 Linaro，awesome 采用 GCC)，主要是为了从架构中获得最佳效果。
> 
> #### 底线是，大多数人从他们在设备上刷新内核的那一刻起就知道他们在 blu_spark 上。我一直在寻找新的东西和方法，尽可能地给出最好的 UX。安全地。

**告诉我们关于你的 blu_active 总督！它是什么，它有什么作用，为什么它很特别？**

> #### 我知道人们有时会混淆 blu_active 和 blu_spark。与我所做的其他工作相比，blu_active 只是一小部分。
> 
> #### CPU 调控器基本上根据系统的需要做出决定，使 CPU 频率上升或下降。自开始以来，调控器已经发生了几次变化和突变。和我做的其他事情一样，我需要一些能满足我需求的东西。它是基于我最喜欢的总督，互动总督。开始的时候，我只是在上面放了一些上游的东西，但是后来我开始添加一些其他的东西，比如 CAF 更新或者我在其他调控器上看到的有用的逻辑。我还添加了 HMP 兼容性和其他一些好东西。
> 
> #### 最新版本基于谷歌的 Linux 4.4 Android 分支，也有一些上游和 CAF 修复，但比以前更精简。简单地充分利用你所拥有的，去掉你没有的。我总是试图获得比股票设置更好的电池，减少消耗，同时试图提高性能(现实生活中的性能，你用眼睛和手指感觉的，而不是用合成工具)。
> 
> #### 有一段时间，我想要一个简单的可调参数，这样人们就可以用一种简单的方式来调整性能。浪子就是这样诞生的:)。逻辑有点类似于本田 VTEC 的工作方式:从给定的阈值开始计时。因此，通过一个简单的开关和一个可变的阈值，人们可以有一个更直接和积极的 cpu 频率扩展。使其根据系统负载迟早进入，绕过目标负载。它与 HMP 完全兼容，可以根据人们的需要在每个集群之间进行切换，针对运行它的每个设备进行微调。

您喜欢/不喜欢原始设备制造商提供的哪些内置机制或调整？即高通的投入增加。

> #### 一些用户空间提升和 HALs(硬件抽象层)中设置的其他可调参数，硬编码的框架等等，有时会很烦人。当然，众所周知，内核开发人员会解决 Nexus 5 上的一些问题，例如，我们大多数人都摆脱了 mpdecision，获得了一个定制的热插拔——当时我们有 blu_plug。其他一些设备的热管理不佳，定制的热控制带有 sysfs，用于控制温度水平、缓解频率等。一些较新的设备在电池、拔芯和其他“低水平”的东西上有一些硬性政策，这些政策并没有真正提高设备的使用率。事实上，它有时甚至会破坏用户体验，所以有必要驯服 CTL 和 BCL 技术。
> 
> #### 我还记得移除设备中的加密时，所有的变化 SELinux 迭代引入的变化使以前的黑客以不同的方式工作...最近的一些 Android 安全变化是一个持续的挑战。其中包括 AVB(某些部分通常被称为 dm-verity)。其他一些更改对必须移动的可调参数和 sysfs 位置进行了限制，因为我们无法访问以前的位置。这些限制中的大部分与库存 rom(我的大部分工作都在其中)更相关，通常它为定制 rom 铺平了道路并使其更容易(在定制 rom 中限制更少)。
> 
> #### 在最近的 SOC 中，如高通骁龙 820 和 835，一些 OEM 厂商增加了一些来自用户空间的提升，这很受欢迎，并解决了系统中的盲点，并非所有 OEM 厂商的东西都是不好的。说到内核源代码，源代码越干净、文档越多越好。

您还喜欢包括哪些其他功能？比如高级色彩控制等等。

> #### 我通常不包括我个人不用的或者我觉得没用的东西。除了 blu_active，我喜欢做的事情还包括架构优化和修复、加密内容更新、IO 调度和其他存储/文件系统功能、KCAL、USB 快速充电、振动强度、电池/通知 LED 控制、唤醒锁拦截器、WireGuard 等。正如我前面所说，我总是使用定制的构建工具链来构建。

你对你的内核使用什么测试方法？你使用用户报告，或基准或任何其他自定义程序吗？

> #### 我拥有我开发的每一部手机，所以任何变化总是由我来测试。由于我每天都长时间驾驶各种设备，所以我发现任何不适合我的设备都不应该适合其他人。当我公开发布一个构建时，它已经经过了我和其他一些我信任的人的大量测试，可以提供有用的反馈。我知道有时一些用户会因为不断地让所有的东西都正常工作而感到厌烦，但是我把稳定性看得比什么都重要:我总是首先站在用户的角度考虑问题。
> 
> #### 我运行的是现实生活中的用例，而不是合成测试。这种软件是为人类设计的，而不是后台办公室的机器。起点永远比股票经验好，各方面都是，但我真的没那么看重最新的安兔兔高分。我的内核可以调整到这种基准，但这不是我的最终目标。我确实重视一些更直接的基准测试，比如 IO 存储测试。例如，它们可以提供一种快速的方法来断言最近所做的一些更改。
> 
> #### 我用股票光盘做测试，这样我就能对事物有一个稳定的基线。我为定制的 rom 做定制的构建，但是由于定制的 rom 的易变的本质，加上额外的东西，夜生活，甚至在一些特性上的实现差异，不幸的是，不可能覆盖它们并且给每个人适当的支持。
> 
> #### 我有时也会构建测试版来测试一些特定的东西，或者在我发布测试版或开发者预览版时使用。我在 Nexus 和一加设备上做过，人们有时喜欢测试一些东西:)

* * *

> [查看第 2 部分:F2FS、EAS 和给有抱负的内核开发人员的提示](http://www.xda-developers.com/interview-eng-stk-blu-spark-kernel-2)