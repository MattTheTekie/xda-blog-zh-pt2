# 谷歌正致力于在安卓系统中安全存储数字驾照

> 原文：<https://www.xda-developers.com/google-android-digital-drivers-license/>

**更新 1(美国东部时间 2019 年 3 月 6 日 8:44 分)**:Android 硬件支持的安全团队负责人 Shawn Willden 分享了谷歌 IdentityCredential API 计划的更多细节。文章最后更新了这些细节。原文如下。

自从我开始使用 Google Pay 管理我的信用卡以来，带钱包对我来说已经不再是必要的了，但我仍然没有办法在没有驾照的情况下去任何地方旅行。我知道有些人用皮夹来装他们*必须*随身携带的那几张卡片，但是我在等待有一天我可以合法地开车去沃尔玛，只带着我的手机。与传统的身份证相比，数字驾照有多种优势。你不能丢失它，你可以远程更新它，这样你就不必在 DMV 排队，如果你的手机被盗，你可以远程擦除它，你不太可能被盗你的身份，因为你不需要携带一个容易访问信息的钱包，你不太可能把你的手机留在家里，你会有一个更容易的时间提出要求。美国各地的当局正在慢慢认识到移动驾照的好处，这就是为什么我们每年都听到更多的美国州测试他们的采用。

例如，路易斯安那州的居民可以下载 [Envoc](https://envoc.com/) 开发的[洛杉矶钱包](https://play.google.com/store/apps/details?id=gov.la.omv.lawallet)应用程序，该应用程序已被洛杉矶执法部门批准用于许可证验证，并被[洛杉矶的 ATC](https://envoc.com/news/envoc-developed-app-la-wallet-wins-atc-approval-for-alcohol-and-tobacco-purchases-in-louisiana) 用于烟酒交易。年龄验证特别有趣，因为用户可以限制移动应用程序，只向酒精或烟草供应商显示必要的信息。在其他地方，数字安全公司[金雅拓](https://www.gemalto.com/drivers-license/extended-offer/digital-ddl)正在与科罗拉多州、爱达荷州、马里兰州、华盛顿特区和怀俄明州合作，在推出他们的数字驾照解决方案之前开展试点项目。与此同时，美国机动车管理人员协会正在努力使这种新形式的电子身份识别标准化。

 <picture>![](img/d43ba2ce0cf0045d9b35518d04325b52.png)</picture> 

A sample image of a digital driver's license accessed through the LA Wallet app. Source: Envoc

不过，电子驾照也有不好的一面。你对谁能看到你的物理 ID 有很大的控制权，但你对谁或什么能访问它的数字化形式却没有太大的控制权。你可以用密码或 PIN 码保护你的手机或下载你的手机许可证的应用程序，但你的手机及其所有数据都有可能遭到破坏。此外，你必须确保你的手机有足够的电量来保持 Android 运行，这样你才能获得许可。有了[身份认证 API](https://android-review.googlesource.com/c/platform/frameworks/base/+/867057) ，谷歌正在努力解决这两个问题。**在未来的 Android 版本中，或许是 Android R，配备合适硬件的设备将能够安全地存储身份证，尤其是数字驾照，甚至可以在设备没有足够的电量启动 Android 时访问它们。**

## 身份认证 API

乍一看，由 Android 硬件支持的密钥库团队负责人 Shawn Willden 提交的提交似乎不是很有趣。然而，如果你查看 IdentityCredential 和 IdentityCredentialStore 文件，你会发现多处提到谷歌所指的“身份凭证”的种类。例如，IdentityCredential 使用一种密钥交换协议，这种协议“被 ISO18013-5 的移动驾驶执照标准使用”此外，该协议被用作“ISO 正在进行的关于[其他标准化身份凭证](https://www.iso.org/ics/35.240.15/x/)的工作的基础。”虽然我们不太可能很快看到移动护照，但很明显，这个 API 不仅仅是为了移动驾驶执照。

深入挖掘，Google 详细阐述了 IdentityCredential API 支持的签名密钥的类型。有两种数据认证:静态和动态。静态认证涉及由发行机构创建的密钥，而动态认证涉及由设备的安全硬件(例如 Pixel 3 和 Pixel 3 XL 中的 [Titan M](https://www.xda-developers.com/google-pixel-3-titan-m-security/) )创建的密钥。)动态认证的好处在于，攻击者更难破坏安全硬件来将凭证复制到另一个设备。此外，动态身份验证使得将特定凭证与用户数据联系起来变得更加困难。

Android 应用程序可以通过要求用户通过 NFC 启动无线连接，向读者提供身份证明。建议应用程序通过以对话框和/或密码保护的形式请求用户许可来保护这些交易。

如果设备具有支持的硬件，即使没有足够的电力来保持 Android 运行，也可以使用“直接访问”模式来呈现身份证明。只有当设备具有分立的安全硬件和足够的电力来操作该硬件以通过 NFC 共享凭证时，这才是可能的。像谷歌 Pixel 2 和谷歌 Pixel 3 这样的设备应该有资格，因为这两款设备都有独立于主 SoC 的[防篡改安全模块](https://www.xda-developers.com/google-details-tamper-resistant-hardware-security-module-pixel-2/)。

如果设备没有独立的安全 CPU，它仍然可以支持 IdentityCredential API，尽管没有直接访问支持。如果凭证存储仅在软件中实现，它可能会受到内核攻击的危害。如果凭证存储在 TEE 中实现，它可能会受到 CPU 上的旁路攻击，如 [Meltdown 和 Spectre](https://www.xda-developers.com/chromebook-meltdown-spectre-how-to-check/) 。如果凭证存储是在与主 CPU 嵌入在同一封装中的独立 CPU 中实现的，则它可以抵御物理硬件攻击，但如果不同时给主 CPU 供电，它就不能被供电。

文档的敏感性将决定是否支持这些身份凭据存储实现中的一个或多个。开发人员可以检查身份凭据存储实现的安全认证。身份凭据存储实现可以是未经认证的，或者评估保证级别为 4 或更高。EAL 告诉应用程序开发人员，实现对潜在攻击有多安全。

正如我之前提到的，Google 打算将这个 API 用于任何标准化的文档类型，尽管他们将 ISO 18013 移动驾驶执照列为一个例子。文档类型是必要的，以便安全硬件知道它是什么类型的凭证，以防应该支持直接访问模式，并允许应用程序知道读者正在请求什么类型的文档。

这就是我们到目前为止关于这个新 API 的所有信息。由于我们非常接近第一个 Android Q 开发者预览版的发布，我认为我们不太可能在 Android Q 中看到对安全存储移动驾照的支持。然而，这个 API 可能会在 Android R 于 2020 年推出时准备好。谷歌 Pixel 2、谷歌 Pixel 3 和即将推出的谷歌 Pixel 4 应该在 Android R 中以直接访问模式支持这种 API，这要归功于拥有必要的独立安全 CPU。如果我们了解到更多关于谷歌打算用这个 API 做什么的信息，我们会让你知道。

* * *

## 更新 1:关于 IdentityCredential API 的更多细节

Shawn Willden，IdentityCredential API commit 的作者，在评论部分分享了关于 API 的更多细节。他回答了用户的一些评论，我们将在下面转载:

用户 Munnimi 表示:

> #### “当警察拿着你的手机走向警车时，他们可以检查手机里有什么。”

威尔登先生回答说:

> #### “我正在努力让这一切变得不可能。这样做的目的是构建流程，使警官无法有效地拿走你的手机。这个想法是，你用警官的手机进行 NFC 窃听，然后用指纹/密码解锁，然后你的手机进入锁定模式，同时通过蓝牙/Wifi 传输数据。锁定模式意味着指纹认证不会解锁，需要密码。这是专门为了强制援引第五修正案防止自证其罪，一些法院发现这并不能阻止警察强迫你用生物特征解锁，但每个人都同意阻止他们强迫你提供密码(至少在美国)。
> 
> #### 请注意，这是一个愿望，而不是一个承诺。我们迫使身份应用开发者流动的方法是有限的，因为如果我们走得太远，他们可以选择不使用我们的 API。但我们能做的是让他们更容易做正确的、对隐私敏感的事情。"

用户 RobboW 表示:

> #### “这在澳大利亚毫无用处。开车时，我们需要随身携带正式的驾驶执照。数字拷贝是身份盗窃的最佳时机。”

威尔登先生回答说:

> #### “澳大利亚是 ISO 18013-5 委员会的积极参与者，对支持移动驾驶执照非常感兴趣。至于身份盗窃，有许多内置的保护措施。文章提到了其中的一些。”

用户 solitarios.lupus 表示:

> #### “考虑到这个网站的作用，我想这里的每个人都知道这是行不通的，对执法部门来说是一个巨大的安全问题。变得容易伪造、仿造和操纵。”

威尔登先生回答说:

> #### “彻底的伪造几乎是不可能的，因为数据都是数字签名的。伪造凭证需要伪造数字签名，这需要彻底破解相关的加密技术(这将破解 TLS 和几乎所有其他东西),或者窃取颁发机构的签名密钥。即使通过从一个 DL 中取出一些签名的数据元素(例如，显示你超过 21 岁的出生日期)和从另一个 DL 中取出一些数据元素(例如，你的真实照片)，也是不可能的，因为签名覆盖了整个文档，将所有元素绑定在一起。”

用户标记声明:

> #### “如果影印件从来都不是有效的身份证件，为什么有电话会有所不同呢？即使谷歌承诺让它变得安全，那怎么能阻止有人展示一个假应用程序呢？
> 
> #### 尽管如此，即使没有答案，我仍然认为这是一件好事，原因在这篇文章中给出。我想用它做护照——不一定是为了旅行，而是其他需要身份证的场合(我不开车，所以我的护照是我唯一的身份证)。
> 
> #### 当然，我也希望英国不会变成一个“请出示证件”的社会，在那里你需要扫描护照，甚至在某些情况下只是去酒吧..."

威尔登先生回答说:

> #### “数字签名将使它变得安全。你可以有一个假的应用程序，但是它不能产生正确签名的数据。
> 
> #### 顺便说一句，护照也在这项工作的范围内。驾驶执照是起点，但协议和基础设施正在精心设计，以支持广泛的身份凭证，具体包括护照。当然，我们需要说服国际民航组织采用这种方法，但我认为这很有可能。"

* * *

*感谢 XDA 公认的开发者 [luca020400](https://forum.xda-developers.com/member.php?u=5778309) 的提示！*