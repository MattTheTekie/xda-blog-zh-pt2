# Tasker Pro:使用音量键跳过音乐曲目，无需 Root！

> 原文：<https://www.xda-developers.com/tasker-pro-skip-music-tracks-using-volume-keys/>

如果你一直渴望**一些非常棒的 Tasker 任务**(并且厌倦了*无聊的*东西，比如告诉你如何重启手机或者摇动手机来唤醒显示屏)，那么我们的 [Tasker Pro 系列](http://xda-developers.com/tag/tasker-pro)就是为你准备的。

我们将发布一系列**高度先进的** Tasker 简介，向你展示 Tasker 有多强大，如果你愿意跳出框框思考的话。在我们的 [Tasker Tips & Tricks](http://forum.xda-developers.com/u/tasker-tips-tricks/guide-automatically-check-md5-sum-t3365590/post66531924#post66531924) 论坛或 Reddit 的/r/Tasker subredit 上，你可以分享并与他人合作如何实现你的想法。

这是 Tasker pro 的第**周 8** 。[上周](http://www.xda-developers.com/control-media-volume-using-volume-keys/)，我们向你展示了如何重新映射你的音量键，只改变媒体音量。本周我们将向你展示如何在屏幕关闭时使用音量键**跳过音乐曲目(不需要 root)！**

在我们开始本周的 Tasker 脚本之前，我想从上周开始说明一件事:在我们的评论中，许多用户推荐使用 AutoInput 来实现更优雅的实现。我会说 AutoInput 对于这个脚本来说是一个非常好的想法，但是我没有推荐它，因为我过去在它上面有问题，并且所需的功能不是该应用程序免费版本的一部分。

* * *

**Tasker Pro #8:音量键音乐控制**

多年来，最受欢迎的定制 ROM 功能之一就是能够只使用音量键来控制媒体播放。该功能无处不在，我可以自信地挑战我们的读者找到一个没有该功能的自定义 ROM(为此自己编译一个是作弊)。没有定制 ROM 的用户已经转向[暴露模块](http://forum.xda-developers.com/xposed/modules/mod-physical-button-music-control-1-8-t2620777)来实现这个非常漂亮的特性。但是，对于那些还没有扎根于手机的用户来说呢？对于这些用户，我将分享一个 Tasker 配置文件，它将允许您复制此功能。我们开始吧。

* * *

**要求**

* * *

**指令**

在我们开始之前，**在 Tasker 的首选项中禁用初学者模式。**

既然已经解决了，你要做的第一件事就是创建一个新的配置文件，并命名为“音量键音乐控制”您将创建两个上下文，一个**事件**和一个**状态**上下文。

事件上下文将是一个**变量集**事件，它应该被设置为检测 **%VOLM** (媒体音量变量)的变化。对于状态上下文，它应该是**显示- >显示状态- >关闭。**这将使该模式仅在您的屏幕关闭且媒体音量改变时才有效。下面，我们将实现实际的逻辑来确定如何在任务中改变轨迹。

以下是该任务的一般逻辑。该任务将检查最后一次音量按钮的按下是否在当前音量按钮按下的 750 毫秒内。如果是，该任务将确定当前的媒体播放器是否是 Spotify(如果你不使用它，可以将其删除，或者换成另一个需要直接控制的应用程序)，然后根据你按下的音量按钮来改变曲目。如果您没有双击按钮，该任务将标记当前时间并保存以前的媒体卷，以防您正在双击。

1.  变量->变量集。将 **%diffpressed** 设置为 **%TIMEMS - %TimePressed。**比较上一次按下音量按钮时和当前音量按钮时的时间戳。这将作为一个门槛，以确定你是否打算改变轨道或只是改变音量。
2.  任务->如果。设置为 If **%diffpressed < 750** 和 **%Vol neq %VOLM。**如果您在 750 毫秒内双击了音量键，并且当前保存的音量与当前媒体音量不相等(稍后您将了解这一点的重要性)，那么我们将决定如何更改曲目。
3.  插件- > KC Tasker 进程。让它选择 **Spotify** 或另一个你知道难以通过传统媒体按钮回放事件控制的媒体应用程序(YouTube，如果你使用 YouTube Red 的话)。将变量设置为 **%spotify** 。(据我所知，像 Spotify 这样的应用是例外，而不是常规，所以如果稍后运行这个任务时，你注意到它没有在你最喜欢的媒体播放器上改变曲目，那么回到这一步，添加其他应用进行检查)。
4.  任务->如果。将其设置为 If **%spotify ~ true。**
5.  媒体->媒体控制。Cmd: **下一个**。模拟媒体按钮:**是。**应用: **Spotify。**检查是否，并将其设置为如果按两次音量增大键， **%VOLM > %Vol.** 将跳到下一首曲目。
6.  媒体->媒体控制。Cmd: **前一个**。模拟媒体按钮:**是。**应用: **Spotify。**检查是否，并将其设置为如果按下音量键两次， **%VOLM < %Vol.** 将跳到上一首曲目。
7.  音频->媒体音量。level:**%不要在这里检查任何东西，这样更改会悄悄地发生。**
8.  任务->其他。接下来的几个动作适用于任何普通的媒体应用程序(例如 Google Play Music)
9.  媒体->媒体控制。Cmd: **接下来。**模拟媒体按钮:**号**检查是否，并将其设置为如果按两次音量增大按钮， **%VOLM > %VOL.** 将跳到下一首曲目。
10.  媒体->媒体控制。Cmd: **以前。**模拟媒体按钮:**号**检查是否，并将其设置为如果按下音量键两次， **%VOLM < %VOL.** 将跳到上一首曲目。
11.  音频->媒体音量。level:**%不要在这里检查任何东西，这样更改会悄悄地发生。**
12.  任务->如果结束。
13.  任务->其他。这将保存当前时间，并将以前的媒体卷保存在变量中。
14.  变量->变量集。将**%时间压缩**设置为**%时间毫秒。**
15.  变量->变量集。将 **%Vol** 设置为 **%VOLM - 1** 。检查 if 并将其设置为 if **%Vol < %VOLM。**
16.  变量->变量集。将 **%Vol** 设置为 **%VOLM + 1。**检查 if 并将其设置为 if **%Vol > %VOLM。**
17.  任务->如果结束。

请注意，在操作 7 和 11 中，我们正在更改媒体音量。由于 Tasker 的工作方式，这将立即导致任务再次运行(因为 Tasker 无法判断是哪个源更改了媒体卷)。这就是为什么在动作 2 中，我们设置条件来检查%Vol new %VOLM，如果两者相等(当这个任务已经运行时，它们将是相等的),这将停止这个任务的运行。

让我们谈谈这种设置的局限性。由于这种设置需要改变媒体音量，这意味着如果您以最大音量收听媒体，并试图双击音量来改变曲目，将不起作用。

最后，关于 AutoInput。是的，这种设置确实可以用 AutoInput 实现，但是有两个原因我不推荐它。第一是它很贵，第二是我无法让它在屏幕关闭时识别按键。

* * *

瞧，瞧！如果你能理解这一点，那么恭喜你，你已经是一个任务大师了！迷茫于一个步骤，只想导入脚本，继续自己的生活？

**如果你想导入这个 Tasker 脚本，可以从 [Android 文件主机](https://www.androidfilehost.com/?fid=24572369242688764)下载。**为了导入个人资料，您需要首先在 Tasker 中禁用初学者模式，方法是进入菜单- >偏好设置。在 UI 选项卡下，取消选中“初学者模式”然后回到主任务菜单，点击“个人资料”标签。然后长按“配置文件”选项卡，并按“导入”导航到下载 my .prf.xml 文件的位置，并选择要导入的文件。一旦你导入了它，你就可以随意使用它了。只要您的屏幕关闭，并且您的媒体音量在 750 毫秒的时间限制内改变两次(并且仅在您双击同一音量按钮时改变曲目)，此配置文件就会运行。

下周 Tasker Pro 我们将会有一个以口袋妖怪 Go 为中心的主题！

[**Check out all Tasker Pro scripts!**](http://www.xda-developers.com/tag/tasker-pro/)

* * *

你想看我和 Tasker 一起做什么？请在下面告诉我们，我们可能会在未来的文章中重点介绍您的想法！